!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="//store.res.meizu.com/order/",e(0)}(function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(typeof t[e]){case"function":break;case"object":t[e]=function(e){var n=e.slice(1),i=t[e[0]];return function(t,e,o){i.apply(this,[t,e,o].concat(n))}}(t[e]);break;default:t[e]=t[t[e]]}return t}([function(t,e,n){n(1);var i=n(7),o=n(8),r=n(14),s=n(18),a=n(29)(),c=n(30).magnet,d=n(31),l=n(52),u=n(62),h=n(75),p=n(91),f=n(32),v=i.extend(!0,{},window.globalData.data),m=i("#validCode"),g=i("#submitForm"),y=i("#totalTips"),b=i("#orderTotal .order-total-valid-row"),x=!1,k=new o({title:"提示",type:"tips"}),w=null;v.codeRule.display&&(w=new s({selector:m,len:v.codeRule.len,type:v.codeRule.type,sid:v.codeRule.verifySid}).on("click",function(){this.$element.css("width",318)}).on("hide",function(){this.$element.css("width",210)}),w.$element.attr({"data-mdesc":"验证码","data-mtype":"store_se_code"}));var C=function(){if(x)return!1;x=!0;var t=u.getCountEndProd(),e=new o({type:"tips",title:"提示",buttons:[{type:"success",text:"上一步",callback:function(){window.location.replace(v.refererUrl)}}]});if(t.length)return e.show({content:t.join(",")+"的价格已发生变化，请重新下单！"}),x=!1,!1;var n=l.getActiveAddressId();if(null===n)return k.show({content:"请选择收货人地址"}),x=!1,!1;if(v.codeRule.display&&!w.getValidateState())return y.text("请先通过安全验证"),x=!1,!1;y.empty();var i=v.codeRule.display?w.getValidateCode():"";_(n,i)},_=function(t,e){var n=u.getProductPointer(),o=Object.keys(n).sort(function(t,e){return n[t].index-n[e].index}).map(function(t){var e=n[t],i={invoiceType:e.invoiceType};return e.invoiceType&&(i.invoiceOrg=e.invoiceOrg,i.invoiceTitle=e.invoiceTitle,2===i.invoiceType&&"03"===i.invoiceOrg&&(i.invoiceTitle=l.getAddressObjectById().receiver),"01"===e.invoiceOrg&&(i.invoiceIdentifySn=e.invoiceIdentifySn,i.invoiceBank=e.invoiceBank,i.invoiceBankAccount=e.invoiceBankAccount)),e.remark&&(i.remark=e.remark),i.orderItems=Object.keys(e.skus).sort(function(t,n){return e.skus[t].index-e.skus[n].index}).map(function(t){var n=e.skus[t],i={skuId:n.skuId,numbers:n.number};return n.packageId&&(i.packageId=n.packageId,i.packageList=n.packageList),i}),i}),r={buyFrom:v.buyFrom,mcode:v.mcode,sourceTime:v.sourceTime,validCode:e,addressId:t,skillTicket:v.skillTicket,payMethodSupport:"1",useMcycle:h.repo.getRepoUseState()?1:0,buyInfos:JSON.stringify(o)},s=h.coupon.getUseCouponId();s&&(r.couponAcquirementId=s);var a=h.red.getUseRedId();return a&&(r.redEnvelopeAcquirementId=a),i.extend(r,f.getPayType()),I(r)},I=function(t){a.get(function(e,n){return e?(k.show({content:e}),void(x=!1)):void i.ajax({url:"/order/submit.html",data:t,headers:{"X-CSRF-TOKEN":n},type:"post",timeout:1e4,beforeSend:r.show.bind(null,"body"),success:function(t){r.hide(),x=!1,200===t.code?f.isWechatPay()?f.handlePay(t.data.url,t.data.timeout,t.data.token):(i(window).off("beforeunload",A),window.location.replace(t.data.url)):t.code>6e3?k.on("hide",function(){i(window).off("beforeunload",A),window.location.replace(t.data.url)}).show({content:t.message}):4e3===t.code?k.once("hide",function(){switch(v.codeRule.display&&w.reset(),t.data.failCouponType){case 1:h.repo.clearRepo();break;case 2:h.coupon.clearCoupon();break;case 3:h.red.clearRed()}}).show({content:t.message}):(v.codeRule.display&&w.reset(),k.show({content:t.message||t.msg}))},error:function(){r.hide(),k.show({content:"网络错误"}),x=!1}})})},A=function(t){var e="您确定要离开吗？";try{var n=t||window.event;n.returnValue=e}catch(i){}return e},$=function(){l.event.on("selectAddress",D),g.on("click",C),i(window).on("beforeunload",A),f.on("success",function(t){i(window).off("beforeunload",A),window.location.replace(t)})},T=function(t){Object.keys(t).forEach(function(e){t[e].$arrival=i(u.setArrival({fastArrivalStatus:0})).replaceAll(t[e].$arrival)})},D=function(t){if(u.getSupportFastArrival()){var e=u.getProductPointer();a.get(function(n,o){i.ajax({url:"/order/check_fast_arrival",headers:{"X-CSRF-TOKEN":o},data:{skus:v.skus,provinceId:t.provinceId,cityId:t.cityId,areaId:t.areaId,townId:t.townId},type:"post",timeout:1e4,beforeSend:r.show.bind(null,l.$addressModule),success:function(t){200===t.code?Object.keys(t.data).forEach(function(n){e[n].$arrival=i(u.setArrival(t.data[n])).replaceAll(e[n].$arrival)}):T(e),r.hide(l.$addressModule)},error:function(){T(e),r.hide(l.$addressModule)}})})}};d.init(v),l.init(v.address),u.init(v.buyInfoList,v.sysTime),f.init(v.huabeis,v.sourceTime,v.huabeiLimit),h.init(v),2!==v.buyInfoList[0].skuInfo[0].type&&p.init(b),$(),c.init({cart:!1})},function(t,e){},,,,,,function(t,e){t.exports=meizuStoreGlobal.jquery},function(t,e,n){n(9);var i=n(7),o=n(11),r=n(12),s="hide",a=function(){return this._events={},r.apply(this,arguments),arguments.length?this.init.apply(this,arguments):this};a.prototype=new r,a.prototype.constructor=a,a.prototype._template=o.template(n(13),{variable:"data"}),a.prototype.defaultOptions={type:"dialog",hasClose:!0,title:"",content:"",contentTitle:"",buttons:[]},a.prototype.init=function(t){var e=this,n={};return n.buttons=[{type:"success",text:"确定",callback:function(){var t=!0;e.emit("beforeSuccess",function(){t=!1}),t&&(e.hide(),e.emit("success"))}}],"tips"!==t.type&&n.buttons.push({type:"cancel",text:"取消",callback:function(){var t=!0;e.emit("beforeCancel",function(){t=!1}),t&&(e.hide(),e.emit("cancel"))}}),this.options=i.extend({},this.defaultOptions,n,t),this.$dialog=i(this._template(this.options)).appendTo("body"),i(".mz-dialog-content",this.$dialog).append(this.options.content),i(".mz-dialog-bottom .mz-btn",this.$dialog).on("click",function(){var t=i(this).index(),n=e.options.buttons[t].callback;i.isFunction(n)&&n.call(e)}),this.options.hasClose&&i(".mz-dialog-close",this.$dialog).on("click",function(){var t=!0;e.emit("beforeClose",function(){t=!1}),t&&(e.hide(),e.emit("close"))}),this._init=!0,this},a.prototype._initDom=function(){return this},a.prototype.show=function(t,e){if(!this._init)return this.init(t).show(t,!0);if(t&&!e&&((t.type||t.className)&&i(".mz-dialog",this.$dialog).attr("class","mz-dialog").addClass((t.type||"")+" "+(t.className||"")),void 0!==t.hasClose&&(t.hasClose?i(".mz-dialog-close",this.$dialog).removeClass(s):i(".mz-dialog-close",this.$dialog).addClass(s)),void 0!==t.title&&i(".mz-dialog-title",this.$dialog).text(t.title),void 0!==t.content&&i(".mz-dialog-content",this.$dialog).empty().append(t.content),void 0!==t.contentTitle&&i(".mz-dialog-content-title",this.$dialog).text(t.contentTitle),i.isArray(t.buttons))){var n=t.buttons.map(function(t){if(!i.isFunction(t.callback))throw new TypeError("Callback must be a function.");return i('<div class="mz-btn '+t.type+'">'+t.text+"</div>").on("click",t.callback.bind(this))});i(".mz-dialog-bottom",this.$dialog).empty().append(n)}var o=!0;return this.emit("beforeShow",function(){o=!1}),o&&(this.$dialog.removeClass(s),this.emit("show")),this},a.prototype.setPosition=function(){var t=i(".mz-dialog",this.$dialog),e=t.outerHeight(),n=t.outerWidth();t.css({marginLeft:-(n/2),marginTop:-(e/2)})},a.prototype.hide=function(){var t=!0;return this.emit("beforeHide",function(){t=!1}),t&&(this.emit("hide"),this.$dialog.addClass(s)),this},a.prototype.destroy=function(){var t=!0;return this.emit("beforeDestroy",function(){t=!1}),t&&(this.emit("destroy"),this.$dialog.remove(),this._init=!1),this},t.exports=a},1,,function(t,e){t.exports=meizuStoreGlobal.underscore},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"number"==typeof t}function r(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!o(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,o,a,c,d;if(this._events||(this._events={}),"error"===t&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(n=this._events[t],s(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(r(n))for(a=Array.prototype.slice.call(arguments,1),d=n.slice(),o=d.length,c=0;c<o;c++)d[c].apply(this,a);return!0},n.prototype.addListener=function(t,e){var o;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?r(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,r(this._events[t])&&!this._events[t].warned&&(o=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[t].length>o&&(this._events[t].warned=!0,"function"==typeof console.trace)),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),o||(o=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var o=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var n,o,s,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],s=n.length,o=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(r(n)){for(a=s;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){o=a;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],i(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e){t.exports='<div class="mz-mask hide">\n  <div class="mz-dialog <%= data.type %> <%= data.className %>">\n    <div class="mz-dialog-header">\n      <div class="mz-dialog-title"><%= data.title %></div>\n      <div class="mz-dialog-close<%= data.hasClose ? \'\' : \' hide\' %>"></div>\n    </div>\n    <div class="mz-dialog-main">\n      <div class="mz-dialog-warp">\n        <% if (data.contentTitle) { %>\n        <div class="mz-dialog-content-title"><%= data.contentTitle %></div>\n        <% } %>\n        <div class="mz-dialog-content"></div>\n      </div>\n    </div>\n    <% if (data.buttons) { %>\n    <div class="mz-dialog-bottom">\n      <% data.buttons.forEach(function(btn) { %>\n      <div class="mz-btn <%= btn.type %>"><%= btn.text %></div>\n      <% }) %>\n    </div>\n    <% } %>\n  </div>\n</div>\n'},function(t,e,n){n(15);var i=n(7),o=n(17)("animation"),r='<div class="mz-loading-mask" />',s='<div class="mz-loading" />',a=['<div class="mz-bounce mz-bounce1"></div>','<div class="mz-bounce mz-bounce2"></div>','<div class="mz-bounce mz-bounce3"></div>'].join(""),c=function(t){var e=i(t||"body");"static"===e.css("position")&&"body"!==e.selector&&e.css("position","relative");var n=!1,c=e.children(".mz-loading-mask");c.length||(c=i(r),n=!0);var d=e.outerHeight(),l=e.outerWidth();if(c.css({width:l,height:d}),!n)return c.show();var u;return u=o?i(s).addClass("spinner").append(a):i(s).addClass("image"),c.append(u).appendTo(e)},d=function(t){var e=i(t||"body"),n=e.children(".mz-loading-mask");return!!n.length&&n.hide()};t.exports={show:c,hide:d}},1,,function(t,e){t.exports=function(t){var e,n=["webkit","Moz","ms","o"],i=[],o=document.documentElement.style,r=function(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})};for(e=0;e<n.length;e++)i.push(r(n[e]+"-"+t));for(i.push(r(t)),e=0;e<i.length;e++)if(i[e]in o)return!0;return!1}},function(t,e,n){n(19);var i=n(7),o=n(21),r=n(12),s=n(28),a=n(14),c=function(){return this._events={},r.apply(this,arguments),this.getImgCount=new s,this.validatedCount=new s,arguments.length>0?this.init.apply(this,arguments):this};c.prototype=new r,c.prototype.constructor=c,c.prototype.init=function(t){var e=this;return this.options=i.extend({},this.defaultOptions,t),this.imgProportion=350/300,this.validated=!1,this.code=null,this.isShowOpener=!1,this.clickPoint=[],this.$element=i('<div class="mz-captcha-input" tabindex="11" hidefocus="true">'+this.texts.hide+"</div>").appendTo(t.selector),280!==this.options.width&&this.$element.css("width",this.options.width),this.$open=i('<div class="mz-captcha-open" tabindex="10" hidefocus="true" />').hide(),this.$tips=i('<div class="mz-captcha-tips">'+this.texts.def+"</div>"),this.$readImgBox=i('<div class="mz-captcha-read" />'),this.$reload=i('<div class="mz-captcha-reload" />'),this.$validate=i('<div class="mz-btn success">验证</div>'),this.$clickImgBox=i('<div class="mz-captcha-click-img" />'),this.$clickBox=i('<div class="mz-captcha-click-box" />'),this.$top=i('<div class="mz-captcha-open-top" />'),this.$center=i('<div class="mz-captcha-open-center" />'),this.$bottom=i('<div class="mz-captcha-open-bottom">'),this.$top.append(this.$tips,this.$readImgBox),this.$center.append(this.$clickImgBox,this.$clickBox),this.$bottom.append(this.$reload,this.$validate),this.$open.append(this.$top,this.$center,this.$bottom).appendTo("body"),this.on("validate",function(t,n){t?e.$element.html(e.texts.validated).addClass("validated"):(e.updateCaptcha(),e.$element.html(e.texts.hide).removeClass("validated")),e.validated=t,e.code=n}),this.on("show",function(){e.isShowOpener=!0,e.validated?e.$element.html(e.texts.validated):e.$element.html(e.texts.unverified)}),this.on("hide",function(){e.isShowOpener=!1,e.validated?e.$element.html(e.texts.validated):e.$element.html(e.texts.hide)}),this.getImgCount.on("end",function(){e.updateCaptcha()}),this.validatedCount.on("end",function(){e.emit("validate",!1)}),this._bind(),this},c.prototype.getValidateState=function(){return this.validated},c.prototype.getValidateCode=function(){return this.code},c.prototype.reset=function(){this.validatedCount.stop(),this.removePoint(),this.emit("validate",!1)},c.prototype._setPosition=function(){var t=this.$element.offset(),e=i(window).scrollTop()+i(window).height(),n=0,o=265;return n=t.top<o||e>o+t.top?t.top+this.$element.height():t.top-o,this.$open.css({top:n,left:t.left,width:this.$element.outerWidth()-2}),this},c.prototype.defaultOptions={imgPrefix:"//store-server.meizu.com/captcha/get",type:6,len:5,sid:null,width:280,timeout:120},c.prototype.texts={def:"请按顺序点击大图中的文字",click:"再次点击图标可取消重选",over:"您以通过验证，无需重复验证",unverified:"安全验证",hide:"点击完成验证",validated:'<i class="mz-captcha-shield"></i>验证通过'},c.prototype._getImg=function(){var t=o.format({query:{type:this.options.type,len:this.options.len,sid:this.options.sid,_t:+new Date}}),e=o.resolve(this.options.imgPrefix,t);return'<img src="'+e+'" class="mz-captcha-img" alt="验证码" />'},c.prototype.updateCaptcha=function(){if(!this.isShow)return!1;var t=this._getImg();this.$readImgBox.html(t),this.$clickImgBox.html(t),this.removePoint(),this.getImgCount.counting&&this.getImgCount.stop(),this.getImgCount.count(this.options.timeout)},c.prototype.show=function(){this._setPosition(),this.$element.addClass("focus"),this.isShow=!0,0===this.getImgCount.options.time&&this.updateCaptcha(),this.$open.show(),this.emit("show")},c.prototype.hide=function(){this.isShow=!1,this.$element.removeClass("focus"),this.$open.hide(),this.emit("hide")},c.prototype.createPoint=function(t,e){if(4==this.clickPoint.length)return!1;var n=this.clickPoint.length+1,o=i('<div class="mz-captcha-click-point" data-index="'+n+'" />');return o.css({top:e-20,left:t-20}),this.clickPoint.push({x:e,y:t,e:o[0]}),this.$tips.html(this.texts.click).removeClass("error"),o},c.prototype.removePoint=function(t){var e=0;if(t){var n=!1;this.clickPoint.forEach(function(o,r){o.e===t&&(e=r,n=!0),n&&i(o.e).remove()})}else this.$clickBox.empty();this.clickPoint.splice(e,4),0===e&&this.$tips.html(this.texts.def)},c.prototype.check=function(){var t=this,e="";this.checking=!0,this.clickPoint.forEach(function(n){var i=n.y*t.imgProportion,o=n.x*t.imgProportion;e+=i+","+o+";"}),i.ajax({url:"//store-server.meizu.com/check_choice_captcha",type:"post",data:{sid:this.options.sid,captcha:e},contentType:"text/plain",beforeSend:a.show.bind(null,t.$open),success:function(e){t.removePoint(),200===e.status?(t.hide(),t.emit("validate",!0,e.randstr),t.validatedCount.count(t.options.timeout)):(t.emit("validate",!1),t.$tips.html(e.error).addClass("error")),t.checking=!1,a.hide(t.$open)},error:function(){t.emit("validate",!1),t.$tips.html("网络错误").addClass("error"),t.checking=!1,a.hide(t.$open)}})},c.prototype._bind=function(){var t=this;this.$reload.on("click",function(){t.updateCaptcha()}),this.$element.on("click",function(){t.isShow?t.hide():t.validated||(t.emit("click"),t.show())}),this.$element.on("blur",function(e){i(document).one("click",function(e){i(e.target).parents(".mz-captcha-open").length&&clearTimeout(t.blurTimeout)}),e.relatedTarget!==t.$open[0]&&(t.blurTimeout=setTimeout(function(){t.emit("blur"),t.hide()},500))}),this.$open.on("blur",function(){t.emit("blur"),t.hide()}),this.$clickBox.on("click",function(e){if(e.target===this){var n=t.createPoint(e.offsetX,e.offsetY);n&&n.appendTo(this),4===t.clickPoint.length&&t.check()}else t.removePoint(e.target)}),this.$validate.on("click",function(){t.clickPoint.length&&!t.validated?t.checking||t.check():t.validated?t.$tips.html(t.texts.over).addClass("error"):t.clickPoint.length||t.$tips.html(t.texts.def).addClass("error")}),i(window).on("resize",function(){t.isShowOpener&&(clearTimeout(t.resizeTimeout),t.resizeTimeout=setTimeout(function(){t._setPosition()},100))})},t.exports=c},1,,function(t,e,n){"use strict";function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(t,e,n){if(t&&d.isObject(t)&&t instanceof i)return t;var o=new i;return o.parse(t,e,n),o}function r(t){return d.isString(t)&&(t=o(t)),t instanceof i?t.format():i.prototype.format.call(t)}function s(t,e){return o(t,!1,!0).resolve(e)}function a(t,e){return t?o(t,!1,!0).resolveObject(e):e}var c=n(22),d=n(24);e.parse=o,e.resolve=s,e.resolveObject=a,e.format=r,e.Url=i;var l=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/,h=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,p=["<",">",'"',"`"," ","\r","\n","\t"],f=["{","}","|","\\","^","`"].concat(p),v=["'"].concat(f),m=["%","/","?",";","#"].concat(v),g=["/","?","#"],y=255,b=/^[+a-z0-9A-Z_-]{0,63}$/,x=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,k={javascript:!0,"javascript:":!0},w={javascript:!0,"javascript:":!0},C={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},_=n(25);i.prototype.parse=function(t,e,n){if(!d.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),o=i!==-1&&i<t.indexOf("#")?"?":"#",r=t.split(o),s=/\\/g;r[0]=r[0].replace(s,"/"),t=r.join(o);var a=t;if(a=a.trim(),!n&&1===t.split("#").length){var u=h.exec(a);if(u)return this.path=a,this.href=a,this.pathname=u[1],u[2]?(this.search=u[2],e?this.query=_.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var p=l.exec(a);if(p){p=p[0];var f=p.toLowerCase();this.protocol=f,a=a.substr(p.length)}if(n||p||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var I="//"===a.substr(0,2);!I||p&&w[p]||(a=a.substr(2),this.slashes=!0)}if(!w[p]&&(I||p&&!C[p])){for(var A=-1,$=0;$<g.length;$++){var T=a.indexOf(g[$]);T!==-1&&(A===-1||T<A)&&(A=T)}var D,P;P=A===-1?a.lastIndexOf("@"):a.lastIndexOf("@",A),P!==-1&&(D=a.slice(0,P),a=a.slice(P+1),this.auth=decodeURIComponent(D)),A=-1;for(var $=0;$<m.length;$++){var T=a.indexOf(m[$]);T!==-1&&(A===-1||T<A)&&(A=T)}A===-1&&(A=a.length),this.host=a.slice(0,A),a=a.slice(A),this.parseHost(),this.hostname=this.hostname||"";var O="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!O)for(var L=this.hostname.split(/\./),$=0,S=L.length;$<S;$++){var z=L[$];if(z&&!z.match(b)){for(var E="",B=0,M=z.length;B<M;B++)E+=z.charCodeAt(B)>127?"x":z[B];if(!E.match(b)){var N=L.slice(0,$),j=L.slice($+1),R=z.match(x);R&&(N.push(R[1]),j.unshift(R[2])),j.length&&(a="/"+j.join(".")+a),this.hostname=N.join(".");break}}}this.hostname.length>y?this.hostname="":this.hostname=this.hostname.toLowerCase(),O||(this.hostname=c.toASCII(this.hostname));var q=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+q,this.href+=this.host,O&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!k[f])for(var $=0,S=v.length;$<S;$++){var U=v[$];if(a.indexOf(U)!==-1){var K=encodeURIComponent(U);K===U&&(K=escape(U)),a=a.split(U).join(K)}}var V=a.indexOf("#");V!==-1&&(this.hash=a.substr(V),a=a.slice(0,V));var H=a.indexOf("?");if(H!==-1?(this.search=a.substr(H),this.query=a.substr(H+1),e&&(this.query=_.parse(this.query)),a=a.slice(0,H)):e&&(this.search="",this.query={}),a&&(this.pathname=a),C[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var q=this.pathname||"",G=this.search||"";this.path=q+G}return this.href=this.format(),this},i.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",i=this.hash||"",o=!1,r="";this.host?o=t+this.host:this.hostname&&(o=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&d.isObject(this.query)&&Object.keys(this.query).length&&(r=_.stringify(this.query));var s=this.search||r&&"?"+r||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||C[e])&&o!==!1?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),i&&"#"!==i.charAt(0)&&(i="#"+i),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),s=s.replace("#","%23"),e+o+n+s+i},i.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},i.prototype.resolveObject=function(t){if(d.isString(t)){var e=new i;e.parse(t,!1,!0),t=e}for(var n=new i,o=Object.keys(this),r=0;r<o.length;r++){var s=o[r];n[s]=this[s]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),c=0;c<a.length;c++){var l=a[c];"protocol"!==l&&(n[l]=t[l])}return C[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!C[t.protocol]){for(var u=Object.keys(t),h=0;h<u.length;h++){var p=u[h];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||w[t.protocol])n.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),n.pathname=f.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var v=n.pathname||"",m=n.search||"";n.path=v+m}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var g=n.pathname&&"/"===n.pathname.charAt(0),y=t.host||t.pathname&&"/"===t.pathname.charAt(0),b=y||g||n.host&&t.pathname,x=b,k=n.pathname&&n.pathname.split("/")||[],f=t.pathname&&t.pathname.split("/")||[],_=n.protocol&&!C[n.protocol];if(_&&(n.hostname="",n.port=null,n.host&&(""===k[0]?k[0]=n.host:k.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),b=b&&(""===f[0]||""===k[0])),y)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,k=f;else if(f.length)k||(k=[]),k.pop(),k=k.concat(f),n.search=t.search,n.query=t.query;else if(!d.isNullOrUndefined(t.search)){if(_){n.hostname=n.host=k.shift();var I=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");I&&(n.auth=I.shift(),n.host=n.hostname=I.shift())}return n.search=t.search,n.query=t.query,d.isNull(n.pathname)&&d.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!k.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var A=k.slice(-1)[0],$=(n.host||t.host||k.length>1)&&("."===A||".."===A)||""===A,T=0,D=k.length;D>=0;D--)A=k[D],"."===A?k.splice(D,1):".."===A?(k.splice(D,1),T++):T&&(k.splice(D,1),T--);if(!b&&!x)for(;T--;T)k.unshift("..");!b||""===k[0]||k[0]&&"/"===k[0].charAt(0)||k.unshift(""),$&&"/"!==k.join("/").substr(-1)&&k.push("");var P=""===k[0]||k[0]&&"/"===k[0].charAt(0);if(_){n.hostname=n.host=P?"":k.length?k.shift():"";var I=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");I&&(n.auth=I.shift(),n.host=n.hostname=I.shift())}return b=b||n.host&&k.length,b&&!P&&k.unshift(""),k.length?n.pathname=k.join("/"):(n.pathname=null,n.path=null),d.isNull(n.pathname)&&d.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var t=this.host,e=u.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,n){var i;(function(t,o){!function(r){function s(t){throw RangeError(L[t])}function a(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i}function c(t,e){var n=t.split("@"),i="";n.length>1&&(i=n[0]+"@",t=n[1]),t=t.replace(O,".");var o=t.split("."),r=a(o,e).join(".");return i+r}function d(t){for(var e,n,i=[],o=0,r=t.length;o<r;)e=t.charCodeAt(o++),e>=55296&&e<=56319&&o<r?(n=t.charCodeAt(o++),56320==(64512&n)?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),o--)):i.push(e);return i}function l(t){return a(t,function(t){var e="";return t>65535&&(t-=65536,e+=E(t>>>10&1023|55296),t=56320|1023&t),e+=E(t)}).join("")}function u(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:k}function h(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function p(t,e,n){var i=0;for(t=n?z(t/I):t>>1,t+=z(t/e);t>S*C>>1;i+=k)t=z(t/S);return z(i+(S+1)*t/(t+_))}function f(t){var e,n,i,o,r,a,c,d,h,f,v=[],m=t.length,g=0,y=$,b=A;for(n=t.lastIndexOf(T),n<0&&(n=0),i=0;i<n;++i)t.charCodeAt(i)>=128&&s("not-basic"),v.push(t.charCodeAt(i));for(o=n>0?n+1:0;o<m;){for(r=g,a=1,c=k;o>=m&&s("invalid-input"),d=u(t.charCodeAt(o++)),(d>=k||d>z((x-g)/a))&&s("overflow"),g+=d*a,h=c<=b?w:c>=b+C?C:c-b,!(d<h);c+=k)f=k-h,a>z(x/f)&&s("overflow"),a*=f;e=v.length+1,b=p(g-r,e,0==r),z(g/e)>x-y&&s("overflow"),y+=z(g/e),g%=e,v.splice(g++,0,y)}return l(v)}function v(t){var e,n,i,o,r,a,c,l,u,f,v,m,g,y,b,_=[];for(t=d(t),m=t.length,e=$,n=0,r=A,a=0;a<m;++a)v=t[a],v<128&&_.push(E(v));for(i=o=_.length,o&&_.push(T);i<m;){for(c=x,a=0;a<m;++a)v=t[a],v>=e&&v<c&&(c=v);for(g=i+1,c-e>z((x-n)/g)&&s("overflow"),n+=(c-e)*g,e=c,a=0;a<m;++a)if(v=t[a],v<e&&++n>x&&s("overflow"),v==e){for(l=n,u=k;f=u<=r?w:u>=r+C?C:u-r,!(l<f);u+=k)b=l-f,y=k-f,_.push(E(h(f+b%y,0))),l=z(b/y);_.push(E(h(l,0))),r=p(n,g,i==o),n=0,++i}++n,++e}return _.join("")}function m(t){return c(t,function(t){return D.test(t)?f(t.slice(4).toLowerCase()):t})}function g(t){return c(t,function(t){return P.test(t)?"xn--"+v(t):t})}var y=("object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof o&&o);y.global!==y&&y.window!==y&&y.self!==y||(r=y);var b,x=2147483647,k=36,w=1,C=26,_=38,I=700,A=72,$=128,T="-",D=/^xn--/,P=/[^\x20-\x7E]/,O=/[\x2E\u3002\uFF0E\uFF61]/g,L={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},S=k-w,z=Math.floor,E=String.fromCharCode;b={version:"1.3.2",ucs2:{decode:d,encode:l},decode:f,encode:v,toASCII:g,toUnicode:m},i=function(){return b}.call(e,n,e,t),!(void 0!==i&&(t.exports=i))}(this)}).call(e,n(23)(t),function(){return this}())},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,n){"use strict";e.decode=e.parse=n(26),e.encode=e.stringify=n(27)},function(t,e){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,i,o){e=e||"&",i=i||"=";var r={};if("string"!=typeof t||0===t.length)return r;var s=/\+/g;t=t.split(e);var a=1e3;o&&"number"==typeof o.maxKeys&&(a=o.maxKeys);var c=t.length;a>0&&c>a&&(c=a);for(var d=0;d<c;++d){var l,u,h,p,f=t[d].replace(s,"%20"),v=f.indexOf(i);v>=0?(l=f.substr(0,v),u=f.substr(v+1)):(l=f,u=""),h=decodeURIComponent(l),p=decodeURIComponent(u),n(r,h)?Array.isArray(r[h])?r[h].push(p):r[h]=[r[h],p]:r[h]=p}return r}},function(t,e){"use strict";var n=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,i,o){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map(function(o){var r=encodeURIComponent(n(o))+i;return Array.isArray(t[o])?t[o].map(function(t){return r+encodeURIComponent(n(t))}).join(e):r+encodeURIComponent(n(t[o]))}).join(e):o?encodeURIComponent(n(o))+i+encodeURIComponent(n(t)):""}},function(t,e,n){var i=n(7),o=n(12),r=function(){return this._events={},o.apply(this,arguments),this.init.apply(this,arguments)};r.prototype=new o,r.prototype.constructor=r,r.prototype.defaultOptions={time:0,step:1,timeStep:1e3},r.prototype.init=function(t){if(this._isInit)return this;var e=this;return this._isInit=!0,this._cumulative=0,this.options=i.extend({},this.defaultOptions,t),this.on("count",function(t){e.options.time=t}),0!==this.options.time&&this.count(this.options.time),this},r.prototype._correct=function(t){if(!this._correctTime)return this._correctTime=+new Date,t;var e=+new Date,n=this.options.timeStep,i=e-n;if(this._cumulative+=i-this._correctTime,this._cumulative>=n){var o=Math.floor(this._cumulative/n);this._cumulative=this._cumulative%n,t-=o*this.options.step}return this._correctTime=e,t},r.prototype.count=function(t,e){if(!e&&this._counting)return!1;var n=this;return t=this._correct(t),this._counting=setTimeout(function(){var e=t-n.options.step;e=e>=0?e:0,n.emit("count",e,t),e>0?n.count(e,!0):(delete n.counting,n.emit("end"))},this.options.timeStep),this},r.prototype.pause=function(){return clearTimeout(this._counting),delete this._counting,this},r.prototype.proceed=function(){return this.count(this.options.time),this},r.prototype.stop=function(){return clearTimeout(this._counting),delete this._counting,delete this._correctTime,this._cumulative=0,this},r.prototype.start=function(t){return this.options=i.extend({},this.options,t),this.count(this.options.time),this},t.exports=r},function(t,e,n){var i=n(7),o=n(12),r=function(){return this._events={},o.apply(this,arguments),this.init.apply(this,arguments);
};r.prototype=new o,r.prototype.constructor=r,r.prototype.init=function(t){return this.options=i.extend({},this.defaultOptions,t),this},r.prototype.defaultOptions={url:"/independent"},r.prototype.get=function(t,e){return!(!t||!i.isFunction(t))&&void i.ajax({url:this.options.url,type:"get",cache:!1,async:!e,success:function(e,n,i){if(200==e.code){var o=i.getResponseHeader("X-CSRF-TOKEN");t(null,o,i)}else t(e.error)},error:function(){t("网络错误")}})},r.prototype.async=function(){var t="";return this.get(function(e,n){if(e)throw Error(e);t=n},!0),t},t.exports=function(t){return new r(t)}},function(t,e){t.exports=meizuStoreGlobal},function(t,e,n){var i=n(7),o=n(32),r=i("#totalRedRow"),s=i("#totalRepoRow"),a=i("#totalCouponRow"),c=i("#totalOrderPrice"),d=i("#totalExpressPrice"),l=i("#totalPayPrice"),u=0,h=0,p=0,f=0,v=0,m=function(t){var e={pay:100*h,repo:100*f,coupon:100*p,red:100*v},n=e.pay-e.repo-e.red-e.coupon;if(t)if("string"==typeof t)n+=e[t];else for(var i=0;i<t.length;i++)n+=e[t[i]];return parseFloat((n/100).toFixed(2))},g=function(t,e){return(100*m(e)-100*t)/100<=0},y=function(t,e){var n=null;switch(t){case"coupon":p=e,n=a;break;case"red":v=e,n=r;break;case"repo":f=e,n=s}e>0?n.show():n.hide(),i(".order-total-price",n).text(e.toFixed(2));var c=m(null);u!==c&&(u=c,o.updateHuabei(c),l.text(c.toFixed(2)))},b=function(t){u=h=t.totalOrderPayMoney,c.text(t.totalOrderMoney.toFixed(2)),l.text(t.totalOrderPayMoney.toFixed(2)),d.text(t.totalExpressFee.toFixed(2))};t.exports={init:b,setPrice:y,getActivePayPrice:m,checkSelectedPriceOver:g}},function(t,e,n){n(33);var i=n(7);n(47);var o,r,s,a,c=n(11),d=n(12),l=n(48),u=n(14),h=n(8),p=n(28),f=i("#orderTotal"),v=i("#payToolsContent"),m=i('<div class="order-pay-dialog-qrcode" />'),g=null,y=null,b=null,x=new d,k=c.template(n(49)),w=c.template(n(50)),C=c.template(n(51)),_="active",I="disabled",A="",$=!1,T=!1,D=null,P=null,O=null,L=null,S=null,z=0,E=!1,B=0,M=new h({type:"tips",title:"提示"}),N=new h({hasClose:!1,className:"order-pay-dialog",title:"请使用微信扫码完成支付",content:m,buttons:[]}),j=function(t){if($){if(t&&(t<z?(D.addClass(I),"Huabei"===s&&F.call(P)):D.removeClass(I)),"Huabei"!==s||!E&&!t)return void(t&&(B=t,E=!0));clearTimeout(S),S=setTimeout(R.bind(null,t),100)}},R=function(t){u.show(f),i.ajax({url:"/order/huabei.html",type:"get",data:{total_money:t||B,source_time:a},success:function(t){u.hide(f),E=!1,200===t.code?U(t.data):M.show({content:t.msg})},error:function(){u.hide(f),M.show({content:"花呗分期服务跑丢了~"})}})},q=function(){i(".order-total-pay-label",v).on("click",F)},F=function(){if(!i(this).hasClass(I)){var t=i(this).parents(".order-total-pay-row").index(),e=i(this).index(),n=l.payType[t],o=n.types[e];O&&O.removeClass(_),i(this).addClass(_),O=i(this),s=o.key,r=n.tool,"Huabei"===o.key?(g.addClass(_),j()):g.removeClass(_),"banks"!==n.name?y.hide():(i("tbody",y).html(w(o)),y.show())}},U=function(t){t.forEach(function(t){t.isDefault&&(o=t.periods),o===t.periods&&(t.isDefault=!0)});var e=i(C({huabeis:t}));e.on("click",function(){var e=i(this).index(),n=t[e];o=n.periods,i(this).addClass(_).siblings().removeClass(_)}),b.html(e)},K=function(t,e,n){a=e,z=n;var o=l.huabei=t||[];o.length||l.payType[0].types.shift(),l.payType[0].types[0].selected=!0,v.html(k(l)),D=i(".order-total-pay-label.huabei",v),P=i(".order-total-pay-label.alipay",v),b=i(".order-total-pay-huabei-content",v),g=i(".order-total-pay-huabei",v),y=i(".order-total-pay-banks-detail",v),r=l.payType[0].tool,s=l.payType[0].types[0].key,O=i(".order-total-pay-label:eq(0)",v),o.length&&($=!0,U(o),i('<div class="order-total-pay-tips" />').text("订单满"+z+"元可分期").appendTo(D)),q()},V=function(){var t={payTool:r,payMethod:s};return"Huabei"===s&&(t.huabei=o),t},H=function(){u.show(m),i.ajax({url:"/order/qrcodeSubmit/"+A,success:function(t){200===t.code?Q(t.data):M.show({content:t.msg}),u.hide(m)},error:function(){u.hide(m),M.show({content:"微信扫一扫服务器开小差啦~"})}})},G=function(t){return(!T||!t)&&(T=!0,void i.ajax({url:"/order/is_paid/"+A,success:function(t){t.data?x.emit("success","//paycenter.meizu.com/web/success.html"):setTimeout(G,3e3)},error:function(){setTimeout(G,3e3)}}))},Q=function(t){m.qrcode({render:"table",text:t.url,width:230,height:230}),L||(L=new p({step:1e3}),L.on("end",H)),L.stop().count(t.timeout),N.show(),G(!0)},X=function(){return"WECHATPAY"===r&&"NATIVE"===s},Y=function(t,e,n){return A=n,Q({url:t,timeout:e})};t.exports={init:K,on:x.on.bind(x),getPayType:V,handlePay:Y,isWechatPay:X,updateHuabei:j}},1,,,,,,,,,,,,,,function(t,e){!function(t){t.fn.qrcode=function(e){function n(t){this.mode=a,this.data=t}function i(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function o(t,e){if(void 0==t.length)throw Error(t.length+"/"+e);for(var n=0;n<t.length&&0==t[n];)n++;this.num=Array(t.length-n+e);for(var i=0;i<t.length-n;i++)this.num[i]=t[i+n]}function r(t,e){this.totalCount=t,this.dataCount=e}function s(){this.buffer=[],this.length=0}var a;n.prototype={getLength:function(){return this.data.length},write:function(t){for(var e=0;e<this.data.length;e++)t.put(this.data.charCodeAt(e),8)}},i.prototype={addData:function(t){this.dataList.push(new n(t)),this.dataCache=null},isDark:function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){if(1>this.typeNumber){for(var t=1,t=1;40>t;t++){for(var e=r.getRSBlocks(t,this.errorCorrectLevel),n=new s,i=0,o=0;o<e.length;o++)i+=e[o].dataCount;for(o=0;o<this.dataList.length;o++)e=this.dataList[o],n.put(e.mode,4),n.put(e.getLength(),c.getLengthInBits(e.mode,t)),e.write(n);if(n.getLengthInBits()<=8*i)break}this.typeNumber=t}this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++)this.modules[n][o]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),7<=this.typeNumber&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=i.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(t,e){for(var n=-1;7>=n;n++)if(!(-1>=t+n||this.moduleCount<=t+n))for(var i=-1;7>=i;i++)-1>=e+i||this.moduleCount<=e+i||(this.modules[t+n][e+i]=0<=n&&6>=n&&(0==i||6==i)||0<=i&&6>=i&&(0==n||6==n)||2<=n&&4>=n&&2<=i&&4>=i)},getBestMaskPattern:function(){for(var t=0,e=0,n=0;8>n;n++){this.makeImpl(!0,n);var i=c.getLostPoint(this);(0==n||t>i)&&(t=i,e=n)}return e},createMovieClip:function(t,e,n){for(t=t.createEmptyMovieClip(e,n),this.make(),e=0;e<this.modules.length;e++)for(var n=1*e,i=0;i<this.modules[e].length;i++){var o=1*i;this.modules[e][i]&&(t.beginFill(0,100),t.moveTo(o,n),t.lineTo(o+1,n),t.lineTo(o+1,n+1),t.lineTo(o,n+1),t.endFill())}return t},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=0==t%2);for(t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=0==t%2)},setupPositionAdjustPattern:function(){for(var t=c.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var n=0;n<t.length;n++){var i=t[e],o=t[n];if(null==this.modules[i][o])for(var r=-2;2>=r;r++)for(var s=-2;2>=s;s++)this.modules[i+r][o+s]=-2==r||2==r||-2==s||2==s||0==r&&0==s}},setupTypeNumber:function(t){for(var e=c.getBCHTypeNumber(this.typeNumber),n=0;18>n;n++){var i=!t&&1==(e>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=i}for(n=0;18>n;n++)i=!t&&1==(e>>n&1),this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=i},setupTypeInfo:function(t,e){for(var n=c.getBCHTypeInfo(this.errorCorrectLevel<<3|e),i=0;15>i;i++){var o=!t&&1==(n>>i&1);6>i?this.modules[i][8]=o:8>i?this.modules[i+1][8]=o:this.modules[this.moduleCount-15+i][8]=o}for(i=0;15>i;i++)o=!t&&1==(n>>i&1),8>i?this.modules[8][this.moduleCount-i-1]=o:9>i?this.modules[8][15-i-1+1]=o:this.modules[8][15-i-1]=o;this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var n=-1,i=this.moduleCount-1,o=7,r=0,s=this.moduleCount-1;0<s;s-=2)for(6==s&&s--;;){for(var a=0;2>a;a++)if(null==this.modules[i][s-a]){var d=!1;r<t.length&&(d=1==(t[r]>>>o&1)),c.getMask(e,i,s-a)&&(d=!d),this.modules[i][s-a]=d,o--,-1==o&&(r++,o=7)}if(i+=n,0>i||this.moduleCount<=i){i-=n,n=-n;break}}}},i.PAD0=236,i.PAD1=17,i.createData=function(t,e,n){for(var e=r.getRSBlocks(t,e),o=new s,a=0;a<n.length;a++){var d=n[a];o.put(d.mode,4),o.put(d.getLength(),c.getLengthInBits(d.mode,t)),d.write(o)}for(a=t=0;a<e.length;a++)t+=e[a].dataCount;if(o.getLengthInBits()>8*t)throw Error("code length overflow. ("+o.getLengthInBits()+">"+8*t+")");for(o.getLengthInBits()+4<=8*t&&o.put(0,4);0!=o.getLengthInBits()%8;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*t)&&(o.put(i.PAD0,8),!(o.getLengthInBits()>=8*t));)o.put(i.PAD1,8);return i.createBytes(o,e)},i.createBytes=function(t,e){for(var n=0,i=0,r=0,s=Array(e.length),a=Array(e.length),d=0;d<e.length;d++){var l=e[d].dataCount,u=e[d].totalCount-l,i=Math.max(i,l),r=Math.max(r,u);s[d]=Array(l);for(var h=0;h<s[d].length;h++)s[d][h]=255&t.buffer[h+n];for(n+=l,h=c.getErrorCorrectPolynomial(u),l=new o(s[d],h.getLength()-1).mod(h),a[d]=Array(h.getLength()-1),h=0;h<a[d].length;h++)u=h+l.getLength()-a[d].length,a[d][h]=0<=u?l.get(u):0}for(h=d=0;h<e.length;h++)d+=e[h].totalCount;for(n=Array(d),h=l=0;h<i;h++)for(d=0;d<e.length;d++)h<s[d].length&&(n[l++]=s[d][h]);for(h=0;h<r;h++)for(d=0;d<e.length;d++)h<a[d].length&&(n[l++]=a[d][h]);return n},a=4;for(var c={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;0<=c.getBCHDigit(e)-c.getBCHDigit(c.G15);)e^=c.G15<<c.getBCHDigit(e)-c.getBCHDigit(c.G15);return(t<<10|e)^c.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;0<=c.getBCHDigit(e)-c.getBCHDigit(c.G18);)e^=c.G18<<c.getBCHDigit(e)-c.getBCHDigit(c.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return c.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case 0:return 0==(e+n)%2;case 1:return 0==e%2;case 2:return 0==n%3;case 3:return 0==(e+n)%3;case 4:return 0==(Math.floor(e/2)+Math.floor(n/3))%2;case 5:return 0==e*n%2+e*n%3;case 6:return 0==(e*n%2+e*n%3)%2;case 7:return 0==(e*n%3+(e+n)%2)%2;default:throw Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new o([1],0),n=0;n<t;n++)e=e.multiply(new o([1,d.gexp(n)],0));return e},getLengthInBits:function(t,e){if(1<=e&&10>e)switch(t){case 1:return 10;case 2:return 9;case a:return 8;case 8:return 8;default:throw Error("mode:"+t)}else if(27>e)switch(t){case 1:return 12;case 2:return 11;case a:return 16;case 8:return 10;default:throw Error("mode:"+t)}else{if(!(41>e))throw Error("type:"+e);switch(t){case 1:return 14;case 2:return 13;case a:return 16;case 8:return 12;default:throw Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),n=0,i=0;i<e;i++)for(var o=0;o<e;o++){for(var r=0,s=t.isDark(i,o),a=-1;1>=a;a++)if(!(0>i+a||e<=i+a))for(var c=-1;1>=c;c++)0>o+c||e<=o+c||0==a&&0==c||s==t.isDark(i+a,o+c)&&r++;5<r&&(n+=3+r-5)}for(i=0;i<e-1;i++)for(o=0;o<e-1;o++)r=0,t.isDark(i,o)&&r++,t.isDark(i+1,o)&&r++,t.isDark(i,o+1)&&r++,t.isDark(i+1,o+1)&&r++,(0==r||4==r)&&(n+=3);for(i=0;i<e;i++)for(o=0;o<e-6;o++)t.isDark(i,o)&&!t.isDark(i,o+1)&&t.isDark(i,o+2)&&t.isDark(i,o+3)&&t.isDark(i,o+4)&&!t.isDark(i,o+5)&&t.isDark(i,o+6)&&(n+=40);for(o=0;o<e;o++)for(i=0;i<e-6;i++)t.isDark(i,o)&&!t.isDark(i+1,o)&&t.isDark(i+2,o)&&t.isDark(i+3,o)&&t.isDark(i+4,o)&&!t.isDark(i+5,o)&&t.isDark(i+6,o)&&(n+=40);for(o=r=0;o<e;o++)for(i=0;i<e;i++)t.isDark(i,o)&&r++;return t=Math.abs(100*r/e/e-50)/5,n+10*t}},d={glog:function(t){if(1>t)throw Error("glog("+t+")");return d.LOG_TABLE[t]},gexp:function(t){for(;0>t;)t+=255;for(;256<=t;)t-=255;return d.EXP_TABLE[t]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)},l=0;8>l;l++)d.EXP_TABLE[l]=1<<l;for(l=8;256>l;l++)d.EXP_TABLE[l]=d.EXP_TABLE[l-4]^d.EXP_TABLE[l-5]^d.EXP_TABLE[l-6]^d.EXP_TABLE[l-8];for(l=0;255>l;l++)d.LOG_TABLE[d.EXP_TABLE[l]]=l;return o.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var i=0;i<t.getLength();i++)e[n+i]^=d.gexp(d.glog(this.get(n))+d.glog(t.get(i)));return new o(e,0)},mod:function(t){if(0>this.getLength()-t.getLength())return this;for(var e=d.glog(this.get(0))-d.glog(t.get(0)),n=Array(this.getLength()),i=0;i<this.getLength();i++)n[i]=this.get(i);for(i=0;i<t.getLength();i++)n[i]^=d.gexp(d.glog(t.get(i))+e);return new o(n,0).mod(t)}},r.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],r.getRSBlocks=function(t,e){var n=r.getRsBlockTable(t,e);if(void 0==n)throw Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var i=n.length/3,o=[],s=0;s<i;s++)for(var a=n[3*s+0],c=n[3*s+1],d=n[3*s+2],l=0;l<a;l++)o.push(new r(c,d));return o},r.getRsBlockTable=function(t,e){switch(e){case 1:return r.RS_BLOCK_TABLE[4*(t-1)+0];case 0:return r.RS_BLOCK_TABLE[4*(t-1)+1];case 3:return r.RS_BLOCK_TABLE[4*(t-1)+2];case 2:return r.RS_BLOCK_TABLE[4*(t-1)+3]}},s.prototype={get:function(t){return 1==(this.buffer[Math.floor(t/8)]>>>7-t%8&1)},put:function(t,e){for(var n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},"string"==typeof e&&(e={text:e}),e=t.extend({},{render:"canvas",width:256,height:256,typeNumber:-1,correctLevel:2,background:"#ffffff",foreground:"#000000"},e),this.each(function(){var n;if("canvas"==e.render){n=new i(e.typeNumber,e.correctLevel),n.addData(e.text),n.make();var o=document.createElement("canvas");o.width=e.width,o.height=e.height;for(var r=o.getContext("2d"),s=e.width/n.getModuleCount(),a=e.height/n.getModuleCount(),c=0;c<n.getModuleCount();c++)for(var d=0;d<n.getModuleCount();d++){r.fillStyle=n.isDark(c,d)?e.foreground:e.background;var l=Math.ceil((d+1)*s)-Math.floor(d*s),u=Math.ceil((c+1)*s)-Math.floor(c*s);r.fillRect(Math.round(d*s),Math.round(c*a),l,u)}}else for(n=new i(e.typeNumber,e.correctLevel),n.addData(e.text),n.make(),o=t("<table></table>").css("width",e.width+"px").css("height",e.height+"px").css("border","0px").css("border-collapse","collapse").css("background-color",e.background),r=e.width/n.getModuleCount(),s=e.height/n.getModuleCount(),a=0;a<n.getModuleCount();a++)for(c=t("<tr></tr>").css("height",s+"px").appendTo(o),d=0;d<n.getModuleCount();d++)t("<td></td>").css("width",r+"px").css("background-color",n.isDark(a,d)?e.foreground:e.background).appendTo(c);n=o,jQuery(n).appendTo(this)})}}(jQuery)},function(t,e){t.exports={payType:[{title:"支付宝",name:"alipay",tool:"ALIPAY",types:[{key:"Huabei",className:"huabei"},{key:"Alipay",className:"alipay"}]},{title:"微信支付",name:"wechat",tool:"WECHATPAY",types:[{key:"NATIVE",className:"wechat"}]},{title:"网上银行",name:"banks",tool:"ALIPAY",types:[{key:"BOCB2C",className:"boc",quota:"储蓄卡：单笔限额50000元，每日限额100000元；信用卡：单笔限额300元，每日限额5000元。",type:"信用卡/储蓄卡",phone:"95566"},{key:"CCB",className:"ccb",quota:"准贷记卡：动态口令卡用户单笔限额5000元，每日限额5000元；网银盾用户单笔限额5000元，每日限额5000元；<br>储蓄卡：动态口令用户限额50000元；网银盾用户限额500000元；<br>信用卡：限额500元。<br>（注：建行企业版的支付限额以在银行设置的限额为准）",type:"信用卡/储蓄卡/准贷记卡",phone:"95533"},{key:"ABC",className:"abc",quota:"储蓄卡：动态口令卡用户单笔限额1000元，每日限额3000元；<br>准贷记卡：动态口令卡用户单笔限额1000元，每日限额3000元；移动证书用户无限额。<br>（注：农行企业版的支付限额以在银行设置的限额为准）",type:"借记卡/准贷记卡",phone:"95599"},{key:"ICBCB2C",className:"icbc",quota:"U盾用户：信用卡单笔限额1000元与信用卡本身限额孰低，每日限额信用卡本身透支限额。储蓄卡单笔限额100万元，每日限额：100万元；<br>柜面注册存量静态密码用户：信用卡每日限额300元与信用卡本身限额孰低，储蓄卡每日限额300元；<br>已开通手机短信认证电子银行口令卡用户：信用卡单笔限额1000元与信用卡本身限额孰低，每日限额000元与信用卡本身限额孰低；储蓄卡单笔限额2000元，每日限额5000元；<br>未开通手机短信认证电子银行口令卡用户：信用卡单笔限额500元与信用卡本身限额孰低，每日限额1000元与信用卡本身限额孰低；储蓄卡单笔限额500元，每日限额1000元。<br>（注：工行企业版的支付限额以在银行设置的限额为准）",type:"信用卡/储蓄卡",phone:"95588"},{key:"COMM",className:"comm",quota:"手机注册版：信用卡限额5000元与信用卡本身限额孰低；储蓄卡和准贷记卡限额5000元；<br>证书认证版：信用卡限额1万元与信用卡本身限额孰低；储蓄卡和准贷记卡限额5万元。",type:"信用卡/储蓄卡/准贷记卡",phone:"95559"},{key:"CMB",className:"cmb",quota:"储蓄卡/准贷记卡：大众版限额500元；专业版无限额；<br>信用卡：单笔限额499.99元，每日限额为信用卡本身透支额度。",type:"信用卡/储蓄卡/准贷记卡",phone:"95555"},{key:"PSBC-DEBIT",className:"psbc",quota:"单张汇票收据限额5000元；<br>邮政网汇e充值：普通账户1次/日；已开通短信提醒的账户3次/日；已安装数字证书的账户不限次数。",type:"不需要邮政账户也可以",phone:"11185"},{key:"CIB",className:"cib",quota:"储蓄卡：证书用户无限额；非证书用户有1000和5000两种限额，由用户在开通网上购物功能时自行选择；e卡每日5000元；<br>信用卡：单笔限额600元，账期内限额10000元。",type:"信用卡/储蓄卡",phone:"95561"}]}]}},function(t,e){t.exports='<% payType.forEach(function (type) { %>\n<div class="order-total-pay-row clearfix">\n  <div class="order-total-pay-title"><%= type.title %></div>\n  <ul class="order-total-pay-list clearfix">\n    <% type.types.forEach(function (tool) { %>\n    <li class="order-total-pay-label <%= tool.className %><%= tool.selected ? \' active\' : \'\' %>">\n      <div class="order-total-pay-radio"></div>\n      <div class="order-total-pay-img"></div>\n      <% if (tool.activity) { %>\n        <div class="order-total-pay-activity"><%= tool.activity %></div>\n      <% } %>\n    </li>\n    <% }) %>\n  </ul>\n  <% if (type.name === \'alipay\' && huabei.length) { %>\n  <div class="order-total-pay-huabei active">\n    <div class="order-total-pay-huabei-content clearfix">\n\n    </div>\n  </div>\n  <% } else if (type.name === \'banks\') { %>\n  <table class="order-total-pay-banks-detail" cellspacing="0" cellpadding="0">\n    <thead>\n    <tr>\n      <th width="150px">银行名称</th>\n      <th width="400px">限额</th>\n      <th width="140px">支持卡种</th>\n      <th width="140px">客服电话</th>\n    </tr>\n    </thead>\n    <tbody>\n    </tbody>\n  </table>\n  <% } %>\n</div>\n<% }) %>\n'},function(t,e){t.exports='<tr class="<%= className %>">\n  <td width="150px"><div class="order-total-pay-img"></div></td>\n  <td width="400px" class="quota"><%= quota %></td>\n  <td width="140px"><%= type %></td>\n  <td width="140px"><%= phone %></td>\n</tr>\n'},function(t,e){t.exports="<% huabeis.forEach(function (huabei) { %>\n<div class=\"order-total-pay-huabei-choose<%= huabei.isDefault ? ' active' : '' %>\">\n  <p class=\"order-total-pay-huabei-top\">\n    <span class=\"order-total-pay-huabei-price\"><%= huabei.price %></span> × <%= huabei.periods %>期\n  </p>\n  <p><%= parseFloat(huabei.fee) ? ('含手续费 ￥' + huabei.fee + '/期') : '免手续费' %></p>\n</div>\n<% }) %>\n"},function(t,e,n){n(53);var i=n(7),o=n(11),r=n(29)(),s=n(14),a=n(55),c=n(8),d=n(12),l=n(59),u="tips",h="data-tips",p=[],f=!1,v=0,m=null,g=null,y=null,b=null,x=!0,k=174,w={name:/^[\u4E00-\u9FA5A-Za-z0-9_\-\(\)\（\）\·]+$/,phone:/^[0-9]{11}$/,detail:/^[\u4E00-\u9FA5A-Za-z0-9_\-\(\)\（\）]+$/},C=i("#addressList"),_=i("#addressAdd"),I=i("#addressModule"),A=i("#orderAddressHasOldTips"),$=i("#orderAddressMore"),T=i(l),D=new c({title:"提示",type:"tips"}),P=new d,O=new c({className:"address-adder",content:T,buttons:[{type:"success",text:"确认",callback:function(){var t=q();if(!t)return!1;var e=F();if(!e)return!1;var n=K();if(!n)return!1;var i=U();return!!i&&void G(t,e,n,i)}},{type:"cancel",text:"取消",callback:function(){this.hide()}}]}),L=n(60),S=o.template(n(61),{variable:"data"}),z=new a({selector:i(".address-adder-select",T),showOther:!0,province:{placeholder:"省份/直辖市"},other:{errorTips:"其他地址不能包含特殊字符",placeholder:"请输入其他街道名称"}}),E=function(){f||(C.find(".order-address-checkbox.add").remove(),v>3&&v<10&&x?i(L).insertAfter(C.children().eq(2)):v<10&&i(L).appendTo(C),x?C.css({height:k}):C.css({height:Math.ceil((v+1)/4)*k}),x&&v>3&&$.css("display","inline-block"))},B=function(t){i(this).addClass("checked").siblings().removeClass("checked"),m=t.id,P.emit("selectAddress",i.extend({},t))},M=function(t,e){var n=i(e.delegateTarget);return i.ajax({url:"/customer_address/remove_submit.html",type:"get",data:{id:t.id},dataType:"json",timeout:1e4,beforeSend:s.show.bind(this,I),success:function(e){200===e.code?(v--,n.remove(),m===t.id&&(m=null),E()):D.show({content:e.message}),s.hide(I)},error:function(){s.hide(I),D.show({content:"网络错误"})}}),!1},N=function(t,e){b=t,y=i(e.delegateTarget),g=t.id,V(t),z.setData({province:{id:t.provinceId,text:t.province},city:{id:t.cityId,text:t.city},area:{id:t.areaId,text:t.area},street:{id:t.townId,text:0==t.townId?"其他":t.town,zipCode:t.zipCode},other:0==t.townId?t.town:""},!!t.isOld),t&&0==t.townId&&i(".address-adder-other",T).show(),O.show({title:"修改地址"}).setPosition()},j=function(t){return t.isOld&&A.css("display","inline-block"),t.isSelected=t.id==m||void 0!==t.useAppointAddr,i(S(t)).on("click",function(){i(this).hasClass("disabled")||i(this).hasClass("checked")||B.call(this,t)}).on("click",".order-address-checkbox-delete",M.bind(this,t)).on("click",".order-address-checkbox-edit,.order-address-checkbox-perfect",N.bind(this,t))},R=function(t){var e;t.useAppointAddr?(m=t.activeAddressId,v=1,f=!0,t.appointAddress.useAppointAddr=t.useAppointAddr,e=j(t.appointAddress),p.push(t.appointAddress)):(m=t.activeAddressId?t.activeAddressId:null,v=t.addressList.length,t.addressList.sort(function(e){return e.id===t.activeAddressId?-1:1}).sort(function(t,e){return t.isOld-e.isOld}),e=i.map(t.addressList,j.bind(this)),p=t.addressList,_.show()),C.append(e),E()},q=function(){var t=i(".address-adder-name",T),e=i.trim(t.val()),n=t.parent();return e.length?e.length>15?(n.addClass(u).attr(h,"收件人姓名过长，请重新输入！"),!1):w.name.test(e)?(n.removeClass(u).attr(h," "),e):(n.addClass(u).attr(h,"请输入正确的收件人姓名！"),!1):(n.addClass(u).attr(h,"请输入收件人姓名！"),!1)},F=function(){var t=i(".address-adder-phone",T),e=i.trim(t.val()),n=t.parent();return e.length?w.phone.test(e)?(n.removeClass(u).attr(h," "),e):(n.addClass(u).attr(h,"请输入正确的手机号码！"),!1):(n.addClass(u).attr(h,"请输入手机号码！"),!1)},U=function(){var t=i(".address-adder-detail",T),e=i.trim(t.val()),n=t.parent();return!e.length||e.length<4?(n.addClass(u).attr(h,"请输入详细地址！"),!1):e.length>50?(n.addClass(u).attr(h,"详细地址过长，请重新输入！"),!1):w.detail.test(e)?(n.removeClass(u).attr(h," "),e):(n.addClass(u).attr(h,"请输入正确的详细地址！"),!1)},K=function(){var t=z.getData(),e=i(".address-adder-select",T);return t.province.id&&t.city.id&&t.area.id&&""!==t.street.id?(e.removeClass(u).attr(h," "),(0!==t.street.id||""!==t.other)&&t):(e.addClass(u).attr(h,"请选择地址"),!1)},V=function(t){i(".address-adder-other",T).hide(),i(".address-adder-name",T).val(t.receiver).parent().removeClass(u),i(".address-adder-phone",T).val(t.telNumber).parent().removeClass(u),i(".address-adder-detail",T).val(t.address).parent().removeClass(u)},H=function(){z.on("change",function(t,e,n){"street"===t&&0===n||"other"===t?i(".address-adder-other",T).show():i(".address-adder-other",T).hide(),O.setPosition()}),C.on("click",".order-address-checkbox.add",function(){V({receiver:"",telNumber:"",address:""}),z.clear(),O.show({title:"添加新地址"}).setPosition()}),$.on("click",function(){x&&(x=!1),E(),i(this).remove()}),i(".address-adder-name",T).on("blur",q),i(".address-adder-phone",T).on("blur",F),i(".address-adder-detail",T).on("blur",U)},G=function(t,e,n,o){if(v>=10&&!g)return void D.show({content:"最多不能超过10个地址"});var a=n.province.text+n.city.text+(n.area.text==n.street.text||0==n.street.id?n.area.text:n.area.text+n.street.text)+n.other+o,c=n.street.zipCode||n.area.zipCode||n.city.zipCode||n.province.zipCode||0,d={provinceId:n.province.id,province:n.province.text,cityId:n.city.id,city:n.city.text,areaId:n.area.id,area:n.area.text,townId:n.street.id,town:0==n.street.id?n.other:n.street.text,zipCode:c,completeAddress:a,address:o,id:g||0,receiver:t,telNumber:e};r.get(function(t,e){return t?void D.show({content:t}):void i.ajax({url:"/customer_address/modify_submit.html",type:"post",data:d,dataType:"json",headers:{"X-CSRF-TOKEN":e},timeout:1e4,beforeSend:s.show.bind(null,I),success:function(t){if(200===t.code){if(g){var e=i(j(d)).replaceAll(y);i.extend(b,d),B.call(e,d)}else v++,d.id=t.data,p.push(d),i(j(d)).appendTo(C).click(),v>3&&!g&&(x=!1,$.remove()),E();b=null,y=null,g=null,O.hide()}else D.show({content:t.message||t.msg});s.hide(I)},error:function(){s.hide(I),D.show({content:"网络错误"})}})})},Q=function(){return m},X=function(t){if(void 0===t&&(t=m),f)return p[0];for(var e=null,n=0;n<p.length;n++)t===p[n].id&&(e=p[n]);return e},Y=function(t){R(t),H()};t.exports={init:Y,event:P,$addressModule:I,getActiveAddressId:Q,getAddressObjectById:X}},1,,function(t,e,n){n(56);var i=n(7),o=n(12),r=n(57),s=function(){return this._events={},o.apply(this,arguments),this.data={province:{id:"",text:"",zipCode:""},city:{id:"",text:"",zipCode:""},area:{id:"",text:"",zipCode:""},street:{id:"",text:"",zipCode:""},other:""},arguments.length>0?this.init.apply(this,arguments):this};s.prototype=new o,s.prototype.constructor=s,s.prototype.levelArray=["province","city","area","street"],s.prototype.cityData={province:{index:0,data:{},json:{}},city:{index:1,data:{},json:{}},area:{index:2,data:{},json:{}},street:{index:3,data:{},json:{}}},s.prototype.defaultOptions={alert:function(t){alert(t)},listValueKey:"code",listTextKey:"name",selector:"",showOther:!1,province:{placeholder:"省/直辖市",name:""},city:{placeholder:"城市",name:""},area:{placeholder:"区/县",name:""},street:{placeholder:"乡镇/街道",name:""},other:{maxlength:10,errorTips:"内容有误",placeholder:"其他",name:""}},s.prototype.init=function(t){this.options=i.extend(!0,{},this.defaultOptions,t);var e=this,n="<div />";return this.DOMS={province:i(n),city:i(n),area:i(n),street:i(n)},this.$otherInput=i(n).addClass("mz-address-other mz-input-warp").append('<input type="text" class="mz-input mz-address-input" placeholder="'+this.options.other.placeholder+'" maxlength="'+this.options.other.maxlength+'" />').hide().attr("name",this.options.other.name),this.$element=i(t.selector).append(this.DOMS.province,this.DOMS.city,this.DOMS.area,this.DOMS.street,this.$otherInput).addClass("mz-address"),i.each(this.DOMS,function(t){e.DOMS[t]=new r({selector:this,placeholder:e.options[t].placeholder,name:e.options[t].name,listValueKey:e.options.listValueKey,listTextKey:e.options.listTextKey}).on("select",e._handleChange.bind(e,t)).on("click",e._handleClick.bind(e,t))}),this.otherInputReg=/^[\u4E00-\u9FA5A-Za-z0-9_\-\(\)\（\）]+$/,i(".mz-input",this.$otherInput).on("input propertychange",function(){var t=i(this).val();e.otherInputReg.test(t)?(e.data.other=t,i(this).parent().removeClass("tips").removeAttr("data-tips")):(e.data.other="",i(this).parent().addClass("tips").attr("data-tips",e.options.other.errorTips)),e.emit("change","other",e.data.other,e.data.other,e.getData())}),this},s.prototype.clear=function(t){t=t||0;for(var e=t;e<this.levelArray.length;e++){var n=this.levelArray[e];this.DOMS[n].clear(),this.data[n]={id:"",text:"",zipCode:""}}return this.data.other="",this.$otherInput.removeClass("tips").removeAttr("data-tips"),this.$otherInput.hide().children().val(""),this},s.prototype.setData=function(t,e,n){if(e){var o=this;this._getData("province",0,function(e){this.DOMS.province.setDownmenu(e).setData(t.province.text),this.data.province={id:o.DOMS.province.options.value,text:o.DOMS.province.options.text,zipCode:""},this._handleChange("province",o.DOMS.province.options.text,o.DOMS.province.options.value),n&&i.isFunction(n)&&n()})}else i.each(t,function(t,e){"other"!=t&&this.DOMS[t].setData(e.text,e.id)}.bind(this)),this.data=i.extend(!0,{},this.data,t),this.$otherInput.removeClass("tips").removeAttr("data-tips"),0==this.data.street.id&&this.options.showOther?this.$otherInput.show().children().val(this.data.other):this.$otherInput.hide(),n&&i.isFunction(n)&&n();return this},s.prototype.getData=function(){return i.extend(!0,{},this.data)},s.prototype._handleClick=function(t){var e=Array.prototype.slice.call(arguments);e.push(this.getData()),this.emit.apply(this,["click"].concat(e));var n=this.cityData[t].index,i=this.levelArray[n-1]||"province",o="province"==t?0:this.data[i].id;this.DOMS[t].$ul||!o&&0!=n||this._getData(t,o,function(e){this.DOMS[t].setDownmenu(e)})},s.prototype._extendCityJson=function(t,e){var n=this;i.each(e,function(e,i){n.cityData[t].json[i[n.options.listValueKey]]=i})},s.prototype._handleChange=function(t,e,n){var i=this.cityData[t].index;if(e&&(this.data[t].id=n,this.data[t].text=e,this.data[t].zipCode=this.cityData[t].json[n].zipCode||"",this.clear(i+1),this.emit("change",t,e,n,this.getData())),i==this.levelArray.length-1)return void(0==n&&this.options.showOther&&this.$otherInput.show());
var o=this.levelArray[i+1];this._getData(o,n,function(t){this.DOMS[o].setDownmenu(t),1==t.length&&(this.DOMS[o].setData(t[0][this.options.listTextKey],t[0][this.options.listValueKey]),this._handleChange(o,t[0][this.options.listTextKey],t[0][this.options.listValueKey]))})},s.prototype._getData=function(t,e,n){return e=e||0,this.cityData[t].data[e]?void setTimeout(function(){n.call(this,this.cityData[t].data[e]),this.emit("data",t,this.cityData[t].data[e])}.bind(this)):void i.ajax({url:"//area.meizu.com/area/child/query/"+e,dataType:"jsonp",success:function(i){i.success?(this.cityData[t].data[e]=i.data,this._extendCityJson(t,i.data),this.emit("data",t,i.data),n.call(this,i.data)):this.options.alert(i.errorMsg)}.bind(this),error:function(){this.options.alert("服务器忙")}.bind(this)})},s.prototype.remove=function(){var t=this;this.clear(),i.each(this.DOMS,function(e,n){n.remove(),t.DOMS[e]=null})},t.exports=s},1,function(t,e,n){n(58);var i=n(7),o=n(12),r=function(){return this._events={},o.apply(this,arguments),arguments.length>0?this.init.apply(this,arguments):this};r.prototype=new o,r.prototype.constructor=r,r.prototype.defaultOptions={placeholder:"",selector:"",text:"",value:"",name:"",listTextKey:"",listValueKey:"",data:null},r.prototype.init=function(t){return this.options=t=i.extend({},this.defaultOptions,t),this.$element=i(t.selector).addClass("mz-selectmenu"),this.$show=i('<input type="text" readonly="readonly" tabindex="-1" class="mz-downmenu-input" />').appendTo(this.$element).attr("placeholder",t.placeholder).val(t.text),this.$value=i('<input type="hidden" tabindex="-1" />').appendTo(this.$element).val(t.value).attr("name",t.name),this.$downmenu=i('<div class="mz-downmenu" />').appendTo("body"),this.setDownmenu(t.data),this.bind(),this},r.prototype.bind=function(){var t=this;this.$show.on("click",function(e){var n=i.extend({},t.options);t.emit("click",n,e),t._setPosition(),t.$downmenu.slideDown(50,function(){t.emit("show",n,e)})}),this.$show.on("blur",function(){t.beforeClose=setTimeout(function(e){var n=i.extend({},t.options);t.$downmenu.slideUp(50,function(){t.emit("blur",n,e)})},200)}),this.$downmenu.on("scroll",function(){clearTimeout(t.beforeClose)}),i(window).on("scroll",function(){t.$element.is(":visible")&&t._setPosition()})},r.prototype._setPosition=function(){var t=this.$element.offset();this.$downmenu.css({top:t.top+this.$element.height(),left:t.left,width:this.$element.outerWidth()-2})},r.prototype.setData=function(t,e){if(void 0==t&&void 0==e)return this;if(void 0==t&&e){if(!this.listObject)return this;i.each(this.listObject,function(n,i){var o=this.options.listValueKey?i[this.options.listValueKey]:i;o==e&&(t=this.options.listTextKey?i[this.options.listTextKey]:n)}.bind(this))}else if(void 0==e&&t){if(!this.listObject)return this;i.each(this.listObject,function(n,i){var o=this.options.listTextKey?i[this.options.listTextKey]:n;o==t&&(e=this.options.listValueKey?i[this.options.listValueKey]:i)}.bind(this))}return this.$show.val(t),this.$value.val(e),this.options.value=e,this.options.text=t,this},r.prototype.getData=function(){var t=this;return{text:t.options.text,value:t.options.value}},r.prototype.setDownmenu=function(t){if(t){var e=this;return this.listObject=t,this.$ul=i('<ul class="mz-downmenu-list" />'),i.each(t,function(t,n){var o=this;this._text=e.options.listTextKey?this[e.options.listTextKey]:t,this._value=e.options.listValueKey?this[e.options.listValueKey]:n,i('<li class="mz-downmenu-item" />').appendTo(e.$ul).text(this._text).on("click",function(n){var r=i.extend({},e.options);e.emit("select",o._text,o._value,r,n,t),o._text!=e.options.text&&(e.$show.val(o._text),e.$value.val(o._value),e.options.value=o._value,e.options.text=o._text,e.emit("change",o._text,o._value,r,n,t)),e.$downmenu.slideUp(50)})}),this.$downmenu.html(this.$ul),this.emit("setDownmenu"),this}},r.prototype.clear=function(){return this.$value.val(""),this.$show.val(""),this.$downmenu.empty(),this.options.value="",this.options.text="",delete this.$ul,this},r.prototype.remove=function(){this.clear(),this.$show.remove(),this.$value.remove(),this.$downmenu.remove()},t.exports=r},1,function(t,e){t.exports='<div class="address-adder-content">\n  <div class="address-adder-row clearfix">\n    <div class="address-adder-title">收货人姓名<span class="address-adder-must">*</span></div>\n    <div class="mz-input-warp"><input type="text" class="mz-input address-adder-name" placeholder="姓名长度不超过15个汉字" value="" maxlength="15" /></div>\n    <div class="address-adder-title">收货人手机号<span class="address-adder-must">*</span></div>\n    <div class="mz-input-warp"><input type="text" class="mz-input address-adder-phone" placeholder="请输入11位手机号" value="" maxlength="11" /></div>\n  </div>\n  <div class="address-adder-row clearfix">\n    <div class="address-adder-title">收货人地址<span class="address-adder-must">*</span></div>\n    <div class="mz-input-warp address-adder-select"></div>\n  </div>\n  <div class="address-adder-row clearfix address-adder-other">\n    <div class="address-adder-title">其他</div>\n  </div>\n  <div class="address-adder-row clearfix">\n    <div class="address-adder-title">详细地址<span class="address-adder-must">*</span></div>\n    <div class="mz-input-warp">\n      <input type="text" class="mz-input address-adder-detail" placeholder="请输入4-50个汉字的详细地址，例如路名、门牌号" value="" maxlength="50" minlength="4" />\n    </div>\n  </div>\n</div>\n'},function(t,e){t.exports='<li class="order-address-checkbox add">\n  <div class="order-address-add-icon"></div>\n  <div class="order-address-add-text">添加新地址</div>\n</li>\n'},function(t,e){t.exports='<li class="order-address-checkbox <%= data.isOld ? \'disabled\' : data.isSelected ? \'checked\' : \'\' %>" data-mdesc="收货人信息" data-mtype="store_se_adr" >\n<div class="order-address-checkbox-top">\n  <div class="order-address-checkbox-name" title="<%= data.receiver %>"><%= data.receiver %></div>\n  <div class="order-address-checkbox-phone"><%= data.telNumber %></div>\n</div>\n<div class="order-address-checkbox-content"><%= data.completeAddress %></div>\n<div class="order-address-checkbox-checked">\n  <div class="order-address-checkbox-tick"></div>\n</div>\n<% if (!data.useAppointAddr) { %>\n<div class="order-address-checkbox-ctrl">\n  <div class="order-address-checkbox-delete"></div>\n  <div class="order-address-checkbox-edit"></div>\n  </div>\n<% } %>\n<% if (data.isOld) { %>\n<div class="order-address-checkbox-tips">\n  因配送地址库升级，提交订单前，请务必完善地址信息，让您享受更好的配送服务。\n  <div class="order-address-checkbox-row">\n    <i class="order-address-checkbox-perfect"></i>\n  </div>\n</div>\n<% } %>\n</li>\n'},function(t,e,n){n(63);var i=n(7);n(65);var o=n(11),r=n(57),s=n(8),a=n(28),c=n(66),d=n(67),l=0,u={},h=[],p=[],f=!1,v=null,m=null,g="data-tips",y="tips",b=/^[\u4E00-\u9FA5A-Za-z0-9_\-\(\)\（\）]+$/,x=i("#orderProductList"),k=[{text:"企业",value:"01",placeholder:"请输入企业抬头全称"},{text:"机关事业单位",value:"02",placeholder:"请输入发票抬头全称"},{text:"个人",value:"03",placeholder:"默认收货人姓名"},{text:"其他",value:"04",placeholder:"请输入发票抬头全称"}],w=o.template(n(68)),C=o.template(n(69),{variable:"data"}),_=o.template(n(70),{variable:"skuInfo"}),I=o.template(n(71),{variable:"data"}),A=o.template(n(72),{variable:"data"}),$=o.template(n(73)),T=function(t){if(0!==t.fastArrivalStatus){var e=c(new Date(t.payDate),"hh:mm");return w({fastArrivalStatus:t.fastArrivalStatus,text:1===t.fastArrivalStatus?"当日达":"次日达",beforeTime:"00:00"===e?"24:00":e,day:1===t.fastArrivalStatus?"今天":2===t.fastArrivalStatus?"明天":"后天",date:c(new Date(t.arrivalDate),"MM月dd日")})}return'<div class="order-product-arrival" />'},D=function(t,e,n,o){return n.skus={},t.map(function(t,r){t.reduceName={0:"套餐优惠",1:"限时折扣优惠"},t.productIndex=r,t.merchantExpressFee=e;var s={$selector:i(_(t)),number:t.number,skuId:t.skuId,index:r},c={skuId:t.skuId,numbers:t.number};if(t.packageId){s.packageId=t.packageId;var u=t.skuInfoBoList.map(function(t){return t.skuId});s.packageList=u.join(","),c.packageId=t.packageId,c.packageList=s.packageList,s.uniqueId=t.skuId+"-"+s.packageId+"-"+u.join("-")}else s.uniqueId=t.skuId;return n.skus[s.uniqueId]=s,t.activeTimeEnd&&(s.countdown=new a({step:1e3}).on("end",function(){p.push('"'+t.itemName+" "+t.cspuDesc+(t.packageId?" "+t.packageName:"")+'"')}).on("count",function(t){i(".order-product-countdown",s.$selector).text("限时特惠：剩余"+d(t).string)}).count(t.activeTimeEnd-l)),o.push(c),s.$selector})},P=function(t){v||(v=new s({title:"发票信息",className:"order-invoice-dialog"}),v.on("beforeSuccess",function(t){var e=this._data._select.getData().value,n={invoiceOrg:e,invoiceIdentifySn:"",invoiceBank:"",invoiceBankAccount:"",invoiceTitle:"03"===e&&2===this._data.invoiceType?"默认为收货人姓名":i.trim(this._data._$invoiceName.val())};if(""===n.invoiceTitle)return this._data._$invoiceName.parent().attr(g,"发票抬头不能为空").addClass(y),t(),!1;if(!b.test(n.invoiceTitle))return this._data._$invoiceName.parent().attr(g,"请输入正确的发票抬头").addClass(y),t(),!1;if(this._data._$invoiceName.parent().removeClass(y),"01"===n.invoiceOrg){if(n.invoiceIdentifySn=this._data._$invoiceIdentifySn.val(),n.invoiceBank=this._data._$invoiceBank.val(),n.invoiceBankAccount=this._data._$invoiceBankAccount.val(),!n.invoiceIdentifySn)return this._data._$invoiceIdentifySn.parent().attr(g,"纳税人识别号不能为空").addClass(y),t(),!1;if(!b.test(n.invoiceIdentifySn))return this._data._$invoiceIdentifySn.parent().attr(g,"请输入正确的纳税人识别号").addClass(y),t(),!1;if(this._data._$invoiceIdentifySn.parent().removeClass(y),""!==n.invoiceBank&&!b.test(n.invoiceBank))return this._data._$invoiceBank.parent().attr(g,"请输入正确的开户行").addClass(y),t(),!1;if(this._data._$invoiceBank.parent().removeClass(y),""!==n.invoiceBankAccount&&!b.test(n.invoiceBankAccount))return this._data._$invoiceBankAccount.parent().attr(g,"请输入正确的开户行账号").addClass(y),t(),!1;this._data._$invoiceBankAccount.parent().removeClass(y),this._data._$invoiceEnterpriseLine||(this._data._$invoiceEnterpriseLine=i("<p />"));var o=A(n);this._data._$invoiceEnterpriseLine.text(o),i(".order-product-invoice-info",this._data.$selector).append(this._data._$invoiceEnterpriseLine)}else this._data._$invoiceEnterpriseLine&&this._data._$invoiceEnterpriseLine.remove();i(".order-product-invoice-title",this._data.$selector).text(n.invoiceTitle),i.extend(this._data,n)}),v.on("hide",function(){this._data._$invoiceContent.detach()})),t._$invoiceContent||(t._$invoiceContent=i(I(t)),t._$invoiceName=i("[name=name]",t._$invoiceContent),t._$invoiceIdentifySn=i("[name=identifySn]",t._$invoiceContent),t._$invoiceBank=i("[name=bank]",t._$invoiceContent),t._$invoiceBankAccount=i("[name=bankAccount]",t._$invoiceContent),t._$invoiceEnterprise=i(".order-invoice-dialog-enterprise",t._$invoiceContent),t._select=new r({selector:i(".order-invoice-dialog-type",t._$invoiceContent),text:"个人",value:"03",listTextKey:"text",listValueKey:"value",data:k}).on("change",function(e,n,i,o,r){t._$invoiceName.attr({placeholder:k[r].placeholder,disabled:"03"===n&&2===t.invoiceType}),"03"===n&&2===t.invoiceType&&t._$invoiceName.val(""),"01"===n?t._$invoiceEnterprise.show():t._$invoiceEnterprise.hide(),v.setPosition()})),v._data=t,v.show({content:t._$invoiceContent}).setPosition()},O=function(t){return t.map(function(t,e){var n=u[t.merchantId]={index:e,$selector:i(C(t)),invoiceType:t.merchantId>1e4?0:2,invoiceOrg:"03"},o={orderItems:[]};h.push(o),2!==n.invoiceType&&(n.invoiceTitle="个人",i(".order-product-invoice-checkbox",n.$selector).on("click",function(){n.invoiceType?(n.invoiceType=0,i(".order-product-invoice-info",n.$selector).addClass("hide")):(n.invoiceType=1,P(n),i(".order-product-invoice-info",n.$selector).removeClass("hide"))})),i(".order-product-invoice-edit",n.$selector).on("click",function(){P(n)}),i(".order-product-remark-input",n.$selector).on("input propertychange",function(){n.remark=i(this).val()}),i("tbody",n.$selector).append(D(t.skuInfo,t.merchantExpressFee,n,o.orderItems));var r=i("tbody .order-product-table-express",n.$selector);return t.supportFastArrival&&(f=!0,n.$arrival=i(T(t.fastArrival)),r.append(n.$arrival)),t.skuInfo[0].preSale&&r.html($({day:t.skuInfo[0].preSaleDesc})),n.$selector})},L=function(){x.on("click",".order-product-invoice-icon",function(){m||(m=new s({type:"msg",title:"电子发票详细介绍",content:n(74),buttons:[]})),m.show()})},S=function(){return p},z=function(){return u},E=function(){return f},B=function(){return h},M=function(t,e){l=e,x.html(O(t)),i("img[data-original]",x).lazyload(),L()};t.exports={init:M,setArrival:T,getCountEndProd:S,getProductStaticData:B,getSupportFastArrival:E,getProductPointer:z}},1,,function(t,e){!function(t,e,n,i){var o=t(e);t.fn.lazyload=function(r){function s(){var e=0;c.each(function(){var n=t(this);if(!d.skip_invisible||n.is(":visible"))if(t.abovethetop(this,d)||t.leftofbegin(this,d));else if(t.belowthefold(this,d)||t.rightoffold(this,d)){if(++e>d.failure_limit)return!1}else n.trigger("appear"),e=0})}var a,c=this,d={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:e,data_attribute:"original",skip_invisible:!1,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};return r&&(i!==r.failurelimit&&(r.failure_limit=r.failurelimit,delete r.failurelimit),i!==r.effectspeed&&(r.effect_speed=r.effectspeed,delete r.effectspeed),t.extend(d,r)),a=d.container===i||d.container===e?o:t(d.container),0===d.event.indexOf("scroll")&&a.bind(d.event,function(){return s()}),this.each(function(){var e=this,n=t(e);e.loaded=!1,n.attr("src")!==i&&n.attr("src")!==!1||n.is("img")&&n.attr("src",d.placeholder),n.one("appear",function(){if(!this.loaded){if(d.appear){var i=c.length;d.appear.call(e,i,d)}t("<img />").bind("load",function(){var i=n.attr("data-"+d.data_attribute);n.hide(),n.is("img")?n.attr("src",i):n.css("background-image","url('"+i+"')"),n[d.effect](d.effect_speed),e.loaded=!0;var o=t.grep(c,function(t){return!t.loaded});if(c=t(o),d.load){var r=c.length;d.load.call(e,r,d)}}).attr("src",n.attr("data-"+d.data_attribute))}}),0!==d.event.indexOf("scroll")&&n.bind(d.event,function(){e.loaded||n.trigger("appear")})}),o.bind("resize",function(){s()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&o.bind("pageshow",function(e){e.originalEvent&&e.originalEvent.persisted&&c.each(function(){t(this).trigger("appear")})}),t(n).ready(function(){s()}),this},t.belowthefold=function(n,r){var s;return s=r.container===i||r.container===e?(e.innerHeight?e.innerHeight:o.height())+o.scrollTop():t(r.container).offset().top+t(r.container).height(),s<=t(n).offset().top-r.threshold},t.rightoffold=function(n,r){var s;return s=r.container===i||r.container===e?o.width()+o.scrollLeft():t(r.container).offset().left+t(r.container).width(),s<=t(n).offset().left-r.threshold},t.abovethetop=function(n,r){var s;return s=r.container===i||r.container===e?o.scrollTop():t(r.container).offset().top,s>=t(n).offset().top+r.threshold+t(n).height()},t.leftofbegin=function(n,r){var s;return s=r.container===i||r.container===e?o.scrollLeft():t(r.container).offset().left,s>=t(n).offset().left+r.threshold+t(n).width()},t.inviewport=function(e,n){return!(t.rightoffold(e,n)||t.leftofbegin(e,n)||t.belowthefold(e,n)||t.abovethetop(e,n))},t.extend(t.expr[":"],{"below-the-fold":function(e){return t.belowthefold(e,{threshold:0})},"above-the-top":function(e){return!t.belowthefold(e,{threshold:0})},"right-of-screen":function(e){return t.rightoffold(e,{threshold:0})},"left-of-screen":function(e){return!t.rightoffold(e,{threshold:0})},"in-viewport":function(e){return t.inviewport(e,{threshold:0})},"above-the-fold":function(e){return!t.belowthefold(e,{threshold:0})},"right-of-fold":function(e){return t.rightoffold(e,{threshold:0})},"left-of-fold":function(e){return!t.rightoffold(e,{threshold:0})}})}(jQuery,window,document)},function(t,e){t.exports=function(t,e){e=e||"yyyy-MM-dd hh:mm:ss";var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in n)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return e}},function(t,e){t.exports=function(t){var e=parseInt(t/864e5,10),n=parseInt((t-864e5*e)/36e5,10),i=parseInt((t-864e5*e-36e5*n)/6e4,10),o=parseInt((t-864e5*e-36e5*n-6e4*i)/1e3,10);e=e>0?e<10?"0"+e:e:0,n=n>0?n<10?"0"+n:n:0,i=i>0?i<10?"0"+i:i:0,o=o>0?o<10?"0"+o:o:0;var r=e>0?" "+e+"天"+n+"时"+i+"分"+o+"秒 ":n>0?" "+n+"时"+i+"分"+o+"秒 ":i>0?i+"分"+o+"秒 ":o+"秒 ";return{day:e,hour:n,minute:i,second:o,string:r}}},function(t,e){t.exports='<div class="order-product-arrival">\n  <% if (fastArrivalStatus !== 3) { %>\n  <p><i class="order-product-arrival-icon"></i><%= text %></p>\n  <% } %>\n  <p><%= beforeTime %>前下单并支付，</p>\n  <p>预计<strong><%= day %>（<%= date %>）</strong>送达</p>\n</div>\n'},function(t,e){t.exports='<table cellpadding="0" cellspacing="0" class="order-product-table">\n  <thead>\n  <tr>\n    <th class="order-product-table-name">\n      <div class="order-product-supplier">\n        供应商：<span class="order-product-supplier-name"><%= data.merchantName %></span>\n        <!--<div class="order-product-supplier-tips">由“<%= data.merchantName %>”负责发货，并提供售后服务</div>-->\n      </div>\n    </th>\n    <th class="order-product-table-price">单价</th>\n    <th class="order-product-table-num">数量</th>\n    <th class="order-product-table-total">小计</th>\n    <th class="order-product-table-express">配送方式</th>\n  </tr>\n  </thead>\n  <tbody></tbody>\n  <tfoot>\n  <tr>\n    <td colspan="5">\n      <div class="order-product-info">\n        <div class="order-product-invoice clearfix">\n          <% if (data.merchantId > 10000) { // 非魅族自营 纸质发票 %>\n          <label for="invoiceNo<%= data.merchantId %>" class="order-product-invoice-label">\n            <input class="order-product-invoice-checkbox" type="checkbox" id="invoiceNo<%= data.merchantId %>">\n            开具发票\n          </label>\n          <% } else { %>\n          <div class="order-product-invoice-type">\n            发票类型：电子发票<div class="order-product-invoice-icon"></div>\n          </div>\n          <% } %>\n          <div class="order-product-invoice-info<%= data.merchantId > 10000 ? \' hide\' : \'\' %>">\n            <p>发票抬头：<span class="order-product-invoice-title"><%= data.merchantId > 10000 ? \'个人\' : \'默认为收货人姓名\' %></span>\n              <span class="order-product-invoice-edit">修改</span></p>\n          </div>\n        </div>\n        <div class="order-product-remark">\n          <span class="order-product-remark-title">备注</span>\n          <textarea class="order-product-remark-input" placeholder="备注..." maxlength="45"></textarea>\n        </div>\n      </div>\n      <div class="order-product-total">\n        合计：<span class="order-product-price red"><%= data.merchantTotalMoney.toFixed(2) %></span>\n      </div>\n    </td>\n  </tr>\n  </tfoot>\n</table>\n'},function(t,e){t.exports='<tr>\n  <td class="order-product-table-name">\n    <a target="_blank" class="order-product-link" href="<%= skuInfo.itemUrl %>" data-mdesc="确认订单信息" data-mtype="store_se_ord">\n      <img class="order-product-image" data-original="<%= skuInfo.image %>@120x120.jpg">\n    </a>\n    <div class="order-product-name">\n      <a target="_blank" class="order-product-link" href="<%= skuInfo.itemUrl %>" data-mdesc="确认订单信息" data-mtype="store_se_ord">\n        <p class="order-product-name-item"><%= skuInfo.itemName %></p>\n        <p class="order-product-name-item"><%= skuInfo.cspuDesc %></p>\n        <% if (skuInfo.packageName) { %>\n        <p class="order-product-name-item order-product-group"><%= skuInfo.packageName %></p>\n        <% } %>\n      </a>\n    </div>\n  </td>\n  <td class="order-product-table-price">\n    <p>\n      <span class="order-product-price"><%= skuInfo.totalPrice.toFixed(2) %></span>\n      <% if (skuInfo.reduceMoney > 0) { %>\n      <span class="order-product-price cancel"><%= skuInfo.totalOriginPrice.toFixed(2) %></span>\n      <% } %>\n    </p>\n    <% if (skuInfo.reduceItems) { %>\n    <div>\n      <div class="order-product-discount<%= skuInfo.reduceItems.length > 1 ? \' more\' : \'\' %>">\n        <div class="order-product-discount-title">\n          <%= skuInfo.reduceItems.length > 1 ? \'优惠\' : skuInfo.reduceName[skuInfo.reduceItems[0].type] %>:\n          <span class="order-product-price sub"><%= skuInfo.reduceMoney.toFixed(2) %></span>\n          <% if (skuInfo.reduceItems.length > 1) { %>\n          <i class="order-product-discount-triangle"></i>\n          <% } %>\n        </div>\n        <% if (skuInfo.reduceItems.length > 1) { %>\n        <ul class="order-product-discount-downmenu">\n          <% skuInfo.reduceItems.forEach(function (reduce) {  %>\n          <li class="order-product-discount-item">\n            <%= skuInfo.reduceName[reduce.type]%>\n            <span class="order-product-price sub"><%= reduce.price.toFixed(2) %></span>\n          </li>\n          <% }) %>\n        </ul>\n        <% } %>\n      </div>\n    </div>\n    <% } %>\n    <% if (skuInfo.activeTimeEnd) { %>\n    <p class="order-product-countdown"></p>\n    <% } %>\n  </td>\n  <td class="order-product-table-num"><%= skuInfo.number %></td>\n  <td class="order-product-table-total">\n    <p class="order-product-price red"><%= skuInfo.payMoney.toFixed(2) %></p>\n  </td>\n  <% if (skuInfo.productIndex === 0) { %>\n  <td class="order-product-table-express" rowspan="999">\n    <p>\n      快递配送：运费<span class="order-product-price red"><%= skuInfo.merchantExpressFee.toFixed(2) %></span>\n    </p>\n  </td>\n  <% } %>\n</tr>\n<% skuInfo.skuInfoBoList.forEach(function (boItem, index) { %>\n<tr class="order-product-table-child<%= index === 0 ? \' first\' : \'\' %>">\n  <td class="order-product-table-name" colspan="4">\n    <a target="_blank" class="order-product-link" href="<%= boItem.itemUrl %>" data-mdesc="确认订单信息" data-mtype="store_se_ord">\n      <img class="order-product-image" data-original="<%= boItem.image %>@120x120.jpg">\n    </a>\n    <div class="order-product-name">\n      <a target="_blank" class="order-product-link" href="<%= boItem.itemUrl %>" data-mdesc="确认订单信息" data-mtype="store_se_ord">\n        <%= boItem.name %>\n      </a>\n    </div>\n  </td>\n</tr>\n<% }) %>\n'},function(t,e){t.exports='<div class="order-invoice-dialog-content">\n  <div class="order-invoice-dialog-row clearfix">\n    <div class="order-invoice-dialog-title must">发票类型</div>\n    <div class="order-invoice-dialog-content">\n      <% if (data.invoiceType === 2) { %>\n      <p class="order-invoice-dialog-content-wrap">电子发票</p>\n      <p class="order-invoice-dialog-desc">电子发票是税局认可的有效凭证，其法律效力、基本用途及使用规定同纸质发票。</p>\n      <% } else { %>\n      <p class="order-invoice-dialog-content-wrap">纸质发票</p>\n      <% } %>\n    </div>\n  </div>\n  <div class="order-invoice-dialog-row clearfix">\n    <div class="order-invoice-dialog-title must">发票抬头</div>\n    <div class="order-invoice-dialog-content">\n      <span class="order-invoice-dialog-type"></span>\n      <span class="mz-input-warp order-invoice-dialog-name">\n        <% if (data.invoiceType === 2) { %>\n        <input type="text" class="mz-input" disabled placeholder="默认发货人姓名" maxlength="45" name="name" value="">\n        <% } else { %>\n        <input type="text" class="mz-input" placeholder="默认发货人姓名" maxlength="45" name="name" value="个人">\n        <% } %>\n      </span>\n    </div>\n  </div>\n  <div class="order-invoice-dialog-row clearfix order-invoice-dialog-enterprise">\n    <div class="order-invoice-dialog-title must">纳税人识别号</div>\n    <div class="order-invoice-dialog-content mz-input-warp">\n      <input type="text" class="mz-input" placeholder="请输入纳税人识别号" maxlength="20" name="identifySn">\n    </div>\n  </div>\n  <div class="order-invoice-dialog-row clearfix order-invoice-dialog-enterprise">\n    <div class="order-invoice-dialog-title">开户行</div>\n    <div class="order-invoice-dialog-content mz-input-warp">\n      <input type="text" class="mz-input" placeholder="请输入开户行全称" maxlength="50" name="bank">\n    </div>\n  </div>\n  <div class="order-invoice-dialog-row clearfix order-invoice-dialog-enterprise">\n    <div class="order-invoice-dialog-title">开户行账号</div>\n    <div class="order-invoice-dialog-content mz-input-warp">\n      <input type="text" class="mz-input" placeholder="请输入开户行账号" maxlength="50" name="bankAccount">\n    </div>\n  </div>\n</div>\n'},function(t,e){t.exports="纳税人识别号：<%= data.invoiceIdentifySn %>\n<% if (data.invoiceBank || data.invoiceBankAccount) { %>\n开户行及账号：<%= data.invoiceBank %> <%= data.invoiceBankAccount.replace(/(.{4})/g, '$1 ') %>\n<% } %>\n"},function(t,e){t.exports='<p>\n  配送方式：<i class="order-font presale"></i>预售商品\n</p>\n<p class="order-product-presale-desc">\n  付款后预计<%= day %>天内发货\n</p>\n'},function(t,e){t.exports='<ul class="einvoice-detail">\n  <li class="q">为什么要选择电子发票？</li>\n  <li class="a">电子发票是纳税义务人通过互联网录入数据，然后开具给客户。电子发票获取更便捷，可重复下载，避免丢失，方便查验，售后维权更有保障。发货效率更高，退换货更方便！电子发票低碳环保，节能减排，符合加强环境保护的国家策略。选择电子发票，省力省心，更能为环境保护贡献一份力。</li>\n  <li class="q">确保电子发票具有法律效力的相关规定有哪些?</li>\n  <li class="a">根据国家税务总局关于推行通过增值税电子发票系统开具的增值税电子普通发票有关问题的公告（国家税务总局公告2015年第84号）的规定，自2016年1月1日起启用。增值税电子普通发票的开票方和受票方需要纸质发票的，可以自行打印增值税电子普通发票的版式文件，其法律效力、基本用途、基本使用规定等与税务机关监制的增值税普通发票相同。</li>\n  <li class="q">怎样收到电子发票？</li>\n  <li class="a">2016年1月1日及之后发货的订单，电子发票将在订单发货后，由系统自动发送到收货人的手机，请留意查收；如未收到，请联系客服热线:400-788-3333或进入官网咨询：<a class="einvoice-detail-link" href="http://live-i.meizu.com/live800/chatClient/chatbox.jsp?companyID=8957&configID=4&enterurl=http://store.meizu.com/explain/einvoice_help.html&pagereferrer=&info=&k=1" target="_blank">在线客服</a>，无需操作后台；2016年1月1日前发货的订单，可在官网商城用户订单详情中查看发票信息。</li>\n  <li class="q">想要传统纸质发票怎么办？</li>\n  <li class="a">魅族商城正式启用电子发票后，不支持自主更换纸质发票。</li>\n  <li class="q">电子发票短信误删了怎么办？</li>\n  <li class="a">用户可联系客服索取电子发票信息，客服热线:400-788-3333或进入官网咨询：<a class="einvoice-detail-link" href="http://live-i.meizu.com/live800/chatClient/chatbox.jsp?companyID=8957&configID=4&enterurl=http://store.meizu.com/explain/einvoice_help.html&pagereferrer=&info=&k=1" target="_blank">在线客服</a>。</li>\n  <li class="q">电子发票是否可以用于报销？</li>\n  <li class="a">电子发票打印后可用于单位报销。</li>\n  <li class="q">电子发票在哪里下载和打印？</li>\n  <li class="a">2016年1月1日及之后发货的订单，电子发票用户可以登录<a class="einvoice-detail-link" href="http://t.cn/R4cdnja" target="_blank">http://t.cn/R4cdnja</a> 凭借短信信息查询电票发票。 2016年1月1日前发货的订单，电子发票依旧在<a class="einvoice-detail-link" href="http://t.cn/Rzm3kyC" target="_blank">http://t.cn/Rzm3kyC</a> 查询。</li>\n  <li class="q">选择开具电子发票的顾客如何办理退换货流程？</li>\n  <li class="a">和原有退换货流程一样，唯一区别是电子发票的用户在办理退换货时无需用户退回电子发票，我司直接按电子发票冲红处理。</li>\n  <li class="q">电子发票可以修改发票抬头吗？</li>\n  <li class="a">目前电子发票抬头默认为收货人姓名，如需修改，请联系客服热线:400-788-3333或进入官网咨询：<a class="einvoice-detail-link" href="http://live-i.meizu.com/live800/chatClient/chatbox.jsp?companyID=8957&configID=4&enterurl=http://store.meizu.com/explain/einvoice_help.html&pagereferrer=&info=&k=1" target="_blank">在线客服</a>。</li>\n</ul>\n'},function(t,e,n){n(76);var i=n(7),o=n(11),r=n(12),s=new r,a=n(62),c=n(77),d=n(81),l=n(85),u=n(31),h=null,p=null,f=null,v=null,m=null,g=i("#discountList"),y=o.template(n(88)),b=o.template(n(89)),x=o.template(n(90),{variable:"data"}),k=".order-discount-item-right",w=".order-discount-item-title",C=".order-discount-item-header",_=".order-discount-item-content",I=function(t,e){t=i(t);var n=i(b({msg:e})).css({display:"none"}).appendTo(t).fadeIn(400);setTimeout(function(){n.fadeOut(400)},2e3)},A=function(){g.on("click",C,function(){var t=i(this).parent(),e=t.data("type"),n=i(this).siblings(_),o=t.hasClass("open"),r=function(t,e){var n=e.siblings(".open");n.children(_).stop(!1,!0).slideUp(400,function(){n.removeClass("open")}),t.stop(!1,!0).slideDown(400),e.addClass("open")};o?n.stop(!1,!0).slideUp(400,function(){n.parent().removeClass("open")}):"repo"!==e||l.getRepoState()?r(n,t):$().then(function(){r(n,t)})}),c.on("updatePrice",function(t){i(k,h).html(t>0?x({price:t}):""),u.setPrice("coupon",t),$().then()}),c.on("error",I),d.on("updatePrice",function(t){i(k,f).html(t>0?x({price:t}):""),u.setPrice("red",t),$().then()}),d.on("error",I),l.on("updatePrice",function(t,e){i(k,p).html(t>0?x({price:t,desc:e&&e>0?"（含魅族补贴）":""}):""),u.setPrice("repo",t)}),l.on("error",I)},$=function(){return l.updateRepoData({skillTicket:v,sourceTime:m,buyInfos:JSON.stringify(a.getProductStaticData()),couponAcquirementId:c.getUseCouponId(),redEnvelopeAcquirementId:d.getUseRedId()},!1)},T=function(t){if(A(),v=t.skillTicket,m=t.sourceTime,h=i(y({mdesc:"优惠券",mtype:"store_se_coupon",className:"order-discount-coupon"})).data("type","coupon"),c.init(t.discountCoupons,i(_,h)),c.getCouponState()){i(w,h).text("使用优惠券"),h.appendTo(g);var e=c.getCouponPrice();e&&(i(k,h).html(x({price:e})),u.setPrice("coupon",e))}f=i(y({mdesc:"红包",mtype:"store_se_rcoupon",className:"order-discount-red"})).data("type","red"),d.init(t.redCoupons,i(_,f)),d.getRedState()&&(i(w,f).text("使用红包"),f.appendTo(g)),p=i(y({mdesc:"回购金",mtype:"store_se_bcoupon",className:"order-discount-repo"})).data("type","repo");var n=l.init(i(_,p),{skillTicket:v,sourceTime:m,buyInfos:JSON.stringify(a.getProductStaticData()),couponAcquirementId:c.getUseCouponId(),redEnvelopeAcquirementId:d.getUseRedId()});i(w,p).text("使用回购金"),p.appendTo(g),n.then(function(){p.addClass("open")}).fail(function(){c.getCouponState()&&h.addClass("open")})};t.exports={init:T,coupon:c,red:d,repo:l,on:s.on.bind(s)}},1,function(t,e,n){n(78);var i=n(7),o=n(11),r=n(12),s=n(66),a=n(31),c=a.checkSelectedPriceOver,d=null,l=!1,u=0,h={},p=new r,f=i('<ul class="order-discount-coupon-list clearfix" />'),v=o.template(n(80)),m=function(){i.each(h,function(){i(this).removeClass("checked")}),d=null,u=0,p.emit("updatePrice",u)},g=function(t){return t.startDate=s(new Date(t.start),"yyyy.MM.dd hh:mm"),t.endDate=s(new Date(t.end),"yyyy.MM.dd hh:mm"),h[t.couponAcquirementId]=i(v(t)).on("click",function(e){if(i(e.target).hasClass("order-discount-coupon-range-link"))return window.open("//lists.meizu.com/page/couponItems/"+t.couponId+".html","_blank"),!1;if(i(this).hasClass("checked"))i(this).removeClass("checked"),d=null,u=0,p.emit("updatePrice",u);else{var n=c(t.reductionQuotaValue,["coupon","repo"]);n?p.emit("error","body","抵扣金额超过订单金额"):(i(this).addClass("checked").siblings(".checked").removeClass("checked"),d=t.couponAcquirementId,u=t.reductionQuotaValue,p.emit("updatePrice",u))}}),h[t.couponAcquirementId]},y=function(t,e){return e.reductionQuotaValue-t.reductionQuotaValue},b=function(t){var e=0,n=null,o=[],r=[];i.each(t,function(t,e){1===e.couponType?o.push(e):r.push(e)}),o.sort(y),r.sort(y),t=o.concat(r);var s=i.map(t,function(t){var i=c(t.reductionQuotaValue,"coupon");return!i&&t.reductionQuotaValue>e&&(e=t.reductionQuotaValue,n=t.couponAcquirementId),g(t)});return n&&(h[n].addClass("checked"),d=n,u=e),s},x=function(){return l},k=function(t,e){if(t&&t.length){l=!0;var n=b(t);f.append(n),e.html(f)}},w=function(){return d},C=function(){return u};t.exports={init:k,on:p.on.bind(p),clearCoupon:m,getCouponState:x,getUseCouponId:w,getCouponPrice:C}},1,,function(t,e){t.exports='<li class="order-discount-coupon-item">\n  <div class="order-discount-coupon-tick <%= couponType == 1 ? \'single\' : \'\' %>">\n    <div class="order-discount-coupon-top clearfix">\n      <div class="order-discount-coupon-top-row">\n        <div class="order-discount-coupon-price"><%= reductionQuotaValue.toFixed(2) %></div>\n        <div class="order-discount-coupon-type"><%= couponType == 1 ? \'单品券\' : \'多品券\' %></div>\n        </div>\n      <div>\n        <div class="order-discount-coupon-title" title="<%= name %>优惠券"><%= name %>优惠券</div>\n        <div class="order-discount-coupon-desc">满<%= consumptionQuota %>可用</div>\n        </div>\n      </div>\n    <div class="order-discount-coupon-bottom">\n      <div class="order-discount-coupon-time"><%= startDate %> - <%= endDate %></div>\n      <div class="clearfix">\n        <div class="order-discount-coupon-range-text" title="适用范围：<%= itemDesc %>">适用范围：<%= itemDesc %></div>\n        <a class="order-discount-coupon-range-link">查看适用></a>\n        </div>\n      </div>\n    </div>\n  <div class="order-discount-coupon-footer">\n    <div class="order-discount-coupon-checkbox"></div>\n  </div>\n</li>\n';
},function(t,e,n){n(82);var i=n(7),o=n(11),r=n(12),s=n(66),a=n(31),c=a.checkSelectedPriceOver,d=!1,l=new r,u=0,h=null,p={},f=o.template(n(84)),v=i('<ul class="order-discount-red-list clearfix" />'),m=function(){i.each(p,function(){i(this).removeClass("checked")}),h=null,u=0,l.emit("updatePrice",u)},g=function(t){return t.startDate=s(new Date(t.start),"yyyy.MM.dd hh:mm"),t.endDate=s(new Date(t.end),"yyyy.MM.dd hh:mm"),p[t.redEnvelopeAcquirementId]=i(f(t)).on("click",function(){if(i(this).hasClass("checked"))i(this).removeClass("checked"),h=null,u=0,l.emit("updatePrice",u);else{var e=c(t.quotaValue,["red","repo"]);e?l.emit("error","body","抵扣金额超过订单金额"):(i(this).addClass("checked").siblings(".checked").removeClass("checked"),h=t.redEnvelopeAcquirementId,u=t.quotaValue,l.emit("updatePrice",u))}}),p[t.redEnvelopeAcquirementId]},y=function(t){return t.sort(function(t,e){return e.quotaValue-t.quotaValue}),i.map(t,g)},b=function(){return d},x=function(t,e){t&&t.length&&(d=!0,v.append(y(t)),e.html(v))},k=function(){return h};t.exports={init:x,on:l.on.bind(l),clearRed:m,getRedState:b,getUseRedId:k}},1,,function(t,e){t.exports='<li class="order-discount-red-item">\n  <div class="order-discount-red-tick">\n    <div class="order-discount-red-price"><%= quotaValue.toFixed(2) %></div>\n    <div class="order-discount-red-name" title="<%= name %>红包"><%= name %>红包</div>\n    <div class="order-discount-red-time"><%= startDate %> - <%= endDate %></div>\n  </div>\n  <div class="order-discount-red-footer">\n    <div class="order-discount-red-checkbox"></div>\n  </div>\n</li>\n'},function(t,e,n){n(86);var i=n(7),o=n(11),r=n(8),s=n(29)(),a=n(14),c=n(12),d=o.template(n(87),{variable:"repo"}),l=new c,u=null,h=!1,p=!1,f=0,v=0,m=new r({type:"tips",title:"提示"}),g=function(){return h},y=function(){return p&&f+v!==0},b=function(t){t.used=p,f=t.use||0,v=t.subsidy||0,u.html(d(t)),p&&l.emit("updatePrice",f+v,v)},x=function(){i("#orderDiscountRepoNotUse",u).click()},k=function(){u.on("click","[name=orderDiscountRepo]",function(){var t=Number(i(this).val());t?(p=!0,l.emit("updatePrice",f+v,v)):(p=!1,l.emit("updatePrice",0))})},w=function(t){var e={};return Object.keys(t).forEach(function(n){t[n]&&(e[n]=t[n])}),e},C=function(t,e){var n=new i.Deferred;return s.get(function(o,r){return o?(n.reject(),void(!e&&m.show({content:"回购金服务跑丢了~"}))):void i.ajax({url:"/order/get_mcycle.html",type:"post",headers:{"X-CSRF-TOKEN":r},data:w(t),beforeSend:a.show.bind(null,u),timeout:1e4,success:function(t){a.hide(u),200===t.code?(h||(h=!0,p=!0),b(t.data),n.resolve()):(n.reject(),l.emit("error","body",t.message||t.msg))},error:function(){a.hide(u),n.reject(),!e&&l.emit("error","body","回购金服务跑丢了~")}})}),n},_=function(t,e){return u=t,k(),C(e,!0,null)};t.exports={init:_,clearRepo:x,getRepoUseState:y,updateRepoData:C,getRepoState:g,on:l.on.bind(l)}},1,function(t,e){t.exports='<div class="order-discount-repo-title">\n  我的回购金余额：\n  <span class="order-discount-repo-price"><%= repo.total.toFixed(2) %></span>\n  <span class="order-discount-repo-desc">（使用说明：系统会根据您选购的商品自动计算出最大可以用回购金数量，以及可享受的魅族商城补贴，该补贴不可退。）</span>\n</div>\n<p class="order-discount-repo-select">\n  <label for="orderDiscountRepoUse">\n    <input type="radio" id="orderDiscountRepoUse" name="orderDiscountRepo" value="1" <%= repo.used ? \'checked="checked"\' : \'\' %> />\n    可使用<span class="order-discount-repo-price"><%= repo.use.toFixed(2) %></span>元回购金\n    <% if (repo.subsidy > 0) { %>\n    +<span class="order-discount-repo-price"><%= repo.subsidy.toFixed(2) %></span>元魅族补贴\n    <% } %>\n  </label>\n</p>\n<p class="order-discount-repo-select">\n  <label for="orderDiscountRepoNotUse">\n    <input type="radio" id="orderDiscountRepoNotUse" name="orderDiscountRepo" value="0" <%= !repo.used ? \'checked="checked"\' : \'\' %> />\n    暂不使用回购金\n  </label>\n</p>\n'},function(t,e){t.exports='<li class="order-discount-item">\n  <div class="order-discount-item-header" data-mdesc="<%= mdesc %>" data-mtype="<%= mtype %>" >\n    <div class="order-discount-item-title"></div>\n    <div class="order-discount-item-right"></div>\n    </div>\n  <div class="order-discount-item-content <%= className %>"></div>\n</li>\n'},function(t,e){t.exports='<div class="order-discount-content-mask">\n  <div class="order-discount-content-tips">\n    <div class="order-discount-content-tips-header">无法选择</div>\n    <div class="order-discount-content-tips-content"><%= msg %></div>\n  </div>\n</div>\n'},function(t,e){t.exports='<span class="order-discount-item-price"><%= data.price.toFixed(2) %><%= data.desc %></span>\n'},function(t,e,n){n(92);var i=n(93),o=function(t){t.append(i)};t.exports={init:o}},1,function(t,e){t.exports='<div class="order-stock-tips-wrap">\n  <div class="order-stock-tips">该订单含付款减库存商品，支付完成后才会为您预留库存！</div>\n</div>\n'}]));